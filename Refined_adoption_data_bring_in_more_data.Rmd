---
title: "Refined Adoption Data"
author: "Jackie"
date: "10 January 2019"
output: html_document
---

#General information and outline of tasks



```{r library, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(ggplot2)
#install.packages('DT')
library(DT)
library(readxl)

#setwd("W:/Weeds/book_chapter_data")
setwd("C:/Users/ouz001/book_chapter_data")

```



For Ricks book chapter we want to merge data from the PA study and the weeds study.

To explore the relationship between advisors and no till.

* Advisors data comes from the PA study we collected in August-October 2012 

* No till data comes from the weeds study collected in March 2014.


These datasets are not compatiable and some work will need to be done to merge them.

###Postcodes

One way to do this is to use the postcodes obtained in the study.
Postcodes are not the best way to do this beacuse they don't always refelect spatial locations.

Using SA2s is a better way to do this but you need to know the location of the farmers.



Postcodes with coordinates are from here.
Note that this is only an approximation since postcodes don't reflect spatial areas
http://www.corra.com.au/australian-postcode-location-data/


Also a couple of things to note about this file:

* this file has postcodes for multiple suburb
e.g. 5007 relates to 4 suburbs so it has 4 entries
* obviously I cant match to all of this and I don't know which one is correct
* so the best I can do is to match it to one
* make the list of postcodes distinct.


###Step 1 Postcodes data (this can be used for the weeds survey too)
The below code chuck is to create the postcode file with a only one set of postcodes.

"file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/postcodes_with_coord_dist.csv" 

```{r list_poscodes_with coords, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

postcodes_with_coord <- read.csv("../Australian_Post_Codes_Lat_Lon.csv")

postcodes_with_coord_dist <- distinct(postcodes_with_coord, postcode, .keep_all = TRUE)
write.csv(postcodes_with_coord_dist, "postcodes_with_coord_dist.csv")

```


##PA survey - advisor dataset

In the PA survey Q3 asks the farmer about LGA (local government area).

This quetsion has been changed to GRDC_RegionQ3 in the data I recieved.
Fortunelty we needed to change the zones later in the study so we obtained the postcodes for the all the responsdent.

I have got a cut down version of the dataset that has; 

* Respondents
* GRDC_RegionQ3 
* state
* region_ReZoned
* Agro_Yr_StartQ34 
* 12postcodes


/Users/ouz001/book_chapter_data/PA/PA_advisors_adoption.csv



we merged 2 WA argroecological zones
we have no QLD farmers
the study has 573 farmers.
Growers were asked a number of questions about advisors but here we have used Q34 to create adoption curves.
"In what year did you start paying for agronomic advice?"

Overall, 52% of growers pay for agronomic advice. There is wide variation in use of paid agronomic advice between regions, reaching 69% in WA North Central and as low as 32% in NSW Central West. 
The general trend remains upward and the proportion of growers expecting to use paid cropping advisers in 5 years time is 63%.  This includes substantial gains in the regions currently with the lowest use such as NSW Central West (32% to 60%); Vic Loddon (36% to 56%); SA Mallee (38%-50%) and Upper EP (45%-61%). 
There appears to be a slowing of the rate of increase once paid cropping adviser use approaches approximately 70%, with only Riverine Plains (74%) and WA North Central (75%) expecting to have greater than 70% use of paid advisers, consultants and agronomists for cropping advice in 5 years time. 
On average growers with paid advisers receive 8 on-farm visits and spend $4500 for agronomic advice . 






The PA study the results are reported by:
states and SLA .





###Step 2 join the postcode data to the survey data

The below code chuck is to join the 'postcodes_with_coord_dist' file to the survey data.
Results are a file called; "file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/advisors_postcodes.csv" 
which I can use to map.

```{r join list_poscodes_with coords to PA study, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

#bring in the PA study
advisors_PA <- read.csv("../PA/PA_advisors_adoption.csv")
advisors_PA1 <- read_excel("../PA/PA_data_rawish.xlsx")
glimpse(advisors_PA)

advisors_PA1 <- select(advisors_PA1, 
                       Respondents,
                       NoTill_YrQ20_PA = NoTill_YrQ20,
                       NoTill_NowQ21_PA = "NoTill_%NowQ21", 
                       First_Aware_AsteerQ24,
                       First_Aware_YmapQ25 ,
                       SoilTest_StartYearQ75)

#join advisors_PA to advisors_PA1 
advisors_PA <- left_join(advisors_PA,
                                  advisors_PA1,
                                  by= "Respondents")



advisors_postcodes1 <- select(advisors_PA, farmer = Respondents,
                            postcode = X12postcodes,
                            GRDC_RegionQ3,
                            region_ReZoned,
                            Agro_Yr_StartQ34,
                            NoTill_YrQ20_PA,
                            NoTill_NowQ21_PA,
                            First_Aware_AsteerQ24,
                            First_Aware_YmapQ25,
                            SoilTest_StartYearQ75
                            ) %>% 
  mutate(study = "advisors_PA")
glimpse(advisors_postcodes1)

#join PA study to postcodes
advisors_postcodes <- left_join(advisors_postcodes1,
                                  postcodes_with_coord_dist,
                                  by= "postcode")

#I can use this outside of R 
write.csv(advisors_postcodes, "advisors_postcodes.csv")
```


### Step 3 map the survey data and create count tables for the zones.

* argoeclogical zones
* regions
* states
* SLA
* regions based on revised GRDC zones (Davids) - not done yet


####step 3a spatial join
Outside of R in Arcmap I have loaded the advisors_postcodes.csv file. "file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/advisors_postcodes.csv" 
and the GRDC shapefile (created by Neil Clark and Assoicates)

"GRDC_AgroEcological_zones_boundaries_06_region"

and run a spatial join creating a new file with the following headings:

* farmer
* postcode
* Agro_Yr_St
* GRDC_Regio
* region_ReZ
* study
* suburb (not needed)
* state
* dc (not needed)
* type (not needed)
* lat
* lon
* FID_2 (not needed)
* AGROECOLOG
* REGIONS
* CATCHMENT (not needed)
* SOURCE (not needed)


"file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/XYadvisors_postcodes_join.xls"

####Step 3b create table

The below code chuck creates tables of number of farmers in PA study per GRDC region 2006.


```{r table of PA study farmer per argozone etc, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}


#read in advisor data with postcodes and zones


XYadvisors_postcodes_join1 <- read.csv("../adoption_data/XYadvisors_postcodes_join.csv")
XYadvisors_postcodes_join1 <- select(XYadvisors_postcodes_join1,
                                     farmer,
                                     postcode,
                                     state,
                                     AGROECOLOG,
                                     REGIONS)

glimpse(XYadvisors_postcodes_join1)

glimpse(advisors_postcodes1)
XYadvisors_postcodes_join <- left_join(advisors_postcodes1, XYadvisors_postcodes_join1, by = "farmer" )
glimpse(XYadvisors_postcodes_join)


#count the number of farmers in each group
advisors_n_AGRO <- data.frame(count(XYadvisors_postcodes_join,AGROECOLOG))
advisors_n_REGIONS <- data.frame(count(XYadvisors_postcodes_join,REGIONS))
advisors_n_state <- data.frame(count(XYadvisors_postcodes_join,state))

advisors_n_GRDC_Regio <- data.frame(count(XYadvisors_postcodes_join,GRDC_Regio))
advisors_n_GRDC_region_ReZ <- data.frame(count(XYadvisors_postcodes_join,region_ReZ))
glimpse(advisors_n_GRDC_Regio)

#make the data frames neat and the names consistant (for joining)
advisors_n_AGRO <- select(advisors_n_AGRO, zone = AGROECOLOG,
                            number_of_farmers = n) %>% 
                            mutate(grouping = "AGRO")
advisors_n_REGIONS <- select(advisors_n_REGIONS, zone = REGIONS,
                            number_of_farmers = n) %>% 
                            mutate(grouping = "REGIONS")
advisors_n_state <- select(advisors_n_state, zone = state,
                            number_of_farmers = n) %>% 
                            mutate(grouping = "state")
#Append some of the data
step1_advisors_n_zones <- rbind(advisors_n_AGRO,
                          advisors_n_REGIONS,
                          advisors_n_state)

#make the rest of the data frames neat and the names consistant (for joining)
advisors_n_GRDC_Regio <- select(advisors_n_GRDC_Regio, zone = GRDC_Regio,
                            number_of_farmers = n) %>% 
                            mutate(grouping = "GRDC_Regio")

advisors_n_GRDC_region_ReZ <- select(advisors_n_GRDC_region_ReZ, zone = region_ReZ,
                            number_of_farmers = n) %>% 
                            mutate(grouping = "region_ReZ")
#append these 2 count datasets
step2_advisors_n_zones <- rbind(advisors_n_GRDC_Regio,
                          advisors_n_GRDC_region_ReZ)
#get the zone into a factors
step2_advisors_n_zones <- mutate(step2_advisors_n_zones, zone = as.factor(zone))


#append the data sets 
advisors_n_zones <- rbind(step1_advisors_n_zones,
                          step2_advisors_n_zones)



datatable(advisors_n_zones)
#and export the data.
write.csv(advisors_n_zones, "advisors_n_zones.csv")
```

Note that in the orginal PA study we linked town, postcodes and SLA2011 (statistical local area - supported for the 2011 census at assist with the transition from ASGC to ASGS).
More infformation here:
http://www.abs.gov.au/websitedbs/censushome.nsf/home/factsheetspoa?opendocument&navpos=450 
I believe I got this from the abs.
It can be found on the shared network here:
"file://FSSA2-ADL/clw-home2/ouz001/PA_Data/Tables%20for%20paper_report/SLA11aAust.dbf"


The below image is a summary of the PA data and what GRDC zones they fall into.
I have overlayed the SLA as hollow polygons.




![](/Users/ouz001/book_chapter_data/PA/PA advisors with postcodes.png)



### Step 4 create and plot cummulative adoption for PA data the advisors.

Use the joined PA data to generate adoption curves.
"file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/XYadvisors_postcodes_join.xls"

* farmer
* postcode
* Agro_Yr_St
* GRDC_Regio
* region_ReZ
* study
* suburb (not needed)
* state
* dc (not needed)
* type (not needed)
* lat
* lon
* FID_2 (not needed)
* AGROECOLOG
* REGIONS
* CATCHMENT (not needed)
* SOURCE (not needed)


#####The below code chuck will cal the cummulative adoption data.

```{r adoption curve PA study farmer per argozone function, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

#read in advisor data with postcodes and zones (this was done earlier step)

XYadvisors_postcodes_join <- read.csv("../adoption_data/XYadvisors_postcodes_join.csv")

#change the year from interger to factor
XYadvisors_postcodes_join <- mutate(XYadvisors_postcodes_join, year_as_factor = as.factor(Agro_Yr_St))
#glimpse(XYadvisors_postcodes_join)

#make a function to generate cummulative data
#my df needs to have a clm called 'AGROECOLOG' and 'year_as_factor'
#the zones need to come out of the 'AGROECOLOG' and I need to have number of farmers in this zone


adoption_curve_function <- function(df, zone, numb_farmers) {
  df_subset <- filter(df, AGROECOLOG == zone)
  count_adoption_year <- count(df_subset,year_as_factor)
  count_adoption_year <- select(count_adoption_year, year = year_as_factor, n)
  years_of_study <- data.frame(year = 1950:2014, 
                               id = 1:65,
                               zone = zone)
  years_of_study <- mutate(years_of_study, year = as.factor(year))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}


```



#### PA Survey data for Advisor adoption for agroecological zone


 



```{r adoption curve PA study farmer per argozone etc, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
#glimpse(XYadvisors_postcodes_join)

NSW_Central <- adoption_curve_function(XYadvisors_postcodes_join, "NSW Central", 24)
NSW_Vic_Slopes <- adoption_curve_function(XYadvisors_postcodes_join, "NSW Vic Slopes", 81)
SA_Midnorth_Lower_Yorke_Eyre <- adoption_curve_function(XYadvisors_postcodes_join, "SA Midnorth-Lower Yorke Eyre", 87)
SA_Vic_Bordertown_Wimmera <- adoption_curve_function(XYadvisors_postcodes_join, "SA Vic Bordertown-Wimmera", 82)
SA_Vic_Mallee <- adoption_curve_function(XYadvisors_postcodes_join, "SA Vic Mallee", 157)
Vic_High_Rainfall <- adoption_curve_function(XYadvisors_postcodes_join, "Vic High Rainfall", 10)
WA_Central <- adoption_curve_function(XYadvisors_postcodes_join, "WA Central", 54)
WA_Eastern <- adoption_curve_function(XYadvisors_postcodes_join, "WA Eastern", 4)
WA_Mallee_Sandplain <- adoption_curve_function(XYadvisors_postcodes_join, "WA Mallee and Sandplain", 42)
WA_Northern <- adoption_curve_function(XYadvisors_postcodes_join, "WA Northern", 28)

advisors_adoption_Agro <- rbind(NSW_Central,
                                NSW_Vic_Slopes,
                                SA_Midnorth_Lower_Yorke_Eyre,
                                SA_Vic_Bordertown_Wimmera,
                                SA_Vic_Mallee,
                                Vic_High_Rainfall,
                                WA_Central,
                                WA_Eastern,
                                WA_Mallee_Sandplain,
                                WA_Northern) 



```


```{r plot advisors agro, echo=FALSE}

ggplot(advisors_adoption_Agro, aes(year, cumm_percent, colour=zone))+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2015)+
  labs(x = "Years",
       y = "percenatge of farmers",
       title = "Adoption of advisor use per agroecological zone",
       subtitle = "WA Eastern has 4 farmers and VIC high rainfall 10")

```


```{r plot advisors agro facet, echo=FALSE}

ggplot(advisors_adoption_Agro, aes(year, cumm_percent, group=zone))+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2015)+
  facet_wrap(.~zone)+
  labs(x = "Years",
       y = "percenatge of farmers")

      #, title = "Adoption of advisor use per agroecological zone",
      # subtitle = "WA Eastern has 4 farmers and VIC high rainfall 10")
ggsave("advisors_adoption_Agro.png")
```


#### PA Survey data for Advisor adoption for regions


```{r adoption curve PA study farmer per regions function, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

adoption_curve_function_REGIONS <- function(df, zone, numb_farmers) {
  df_subset <- filter(df, REGIONS == zone)
  count_adoption_year <- count(df_subset,year_as_factor)
  count_adoption_year <- select(count_adoption_year, year = year_as_factor, n)
  years_of_study <- data.frame(year = 1950:2014, 
                               id = 1:65,
                               zone = zone)
  years_of_study <- mutate(years_of_study, year = as.factor(year))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}

```




```{r adoption curve PA study farmer per regions, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
#glimpse(XYadvisors_postcodes_join)

Southern <- adoption_curve_function_REGIONS(XYadvisors_postcodes_join, "Southern", 441)
Western <- adoption_curve_function_REGIONS(XYadvisors_postcodes_join, "Western", 128)

#Northern <- adoption_curve_function_REGIONS(XYadvisors_postcodes_join, "Northern", xx)


advisors_adoption_REGIONS <- rbind(Southern,
                                Western) 



```



```{r plot advisors REGIONS, echo=FALSE}

ggplot(advisors_adoption_REGIONS, aes(year, cumm_percent, group=zone))+
  geom_line(aes(linetype=zone))+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2015)+
  ylim(0, 100)+
  labs(x = "Years",
       y = "percenatge of farmers")
#,       title = "Adoption of advisor use per regions",
 #      subtitle = "This study has no farmers in Northern region ")

ggsave("advisors_adoption_region.png")


```



```{r adoption curve PA study farmer per states function, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
adoption_curve_function_states <- function(df, zone, numb_farmers) {
  df_subset <- filter(df, state == zone)
  count_adoption_year <- count(df_subset,year_as_factor)
  count_adoption_year <- select(count_adoption_year, year = year_as_factor, n)
  years_of_study <- data.frame(year = 1950:2014, 
                               id = 1:65,
                               zone = zone)
  years_of_study <- mutate(years_of_study, year = as.factor(year))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}
```

```{r adoption curve PA study farmer per states, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
#glimpse(XYadvisors_postcodes_join)

NSW <- adoption_curve_function_states(XYadvisors_postcodes_join, "NSW", 105)
SA <- adoption_curve_function_states(XYadvisors_postcodes_join, "SA", 186)
VIC <- adoption_curve_function_states(XYadvisors_postcodes_join, "VIC", 150)
WA <- adoption_curve_function_states(XYadvisors_postcodes_join, "WA", 128)



advisors_adoption_states <- rbind(NSW,SA,VIC,WA)
                                 


```


```{r plot advisors states, echo=FALSE}

ggplot(advisors_adoption_states, aes(year, cumm_percent, colour=zone))+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2015)+
  labs(x = "Years",
       y = "percenatge of farmers",
       title = "Adoption of advisor use per states",
       subtitle = "This study has no farmers in QLD")

```


####PA OTHER CURVES BY STATE#####

###NEED TO CHNAGE CLM Called Year###

```{r adoption curve PA NO TILL study farmer per states function, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

glimpse(XYadvisors_postcodes_join)

adoption_curve_function_states_NOTILL_PA <- function(df, zone, numb_farmers) {
  df_subset <- filter(df, state == zone)
  count_adoption_year <- count(df_subset,NoTill_YrQ20_PA)
  count_adoption_year <- select(count_adoption_year, year = NoTill_YrQ20_PA, n)
  years_of_study <- data.frame(year = 1950:2014, 
                               id = 1:65,
                               zone = zone)
  years_of_study <- mutate(years_of_study, year = as.factor(NoTill_YrQ20_PA))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}
```

```{r adoption curve PA NO TILL study farmer per states, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
#glimpse(XYadvisors_postcodes_join)

NSW <- adoption_curve_function_states_NOTILL_PA(XYadvisors_postcodes_join, "NSW", 105)
SA <- adoption_curve_function_states_NOTILL_PA(XYadvisors_postcodes_join, "SA", 186)
VIC <- adoption_curve_function_states_NOTILL_PA(XYadvisors_postcodes_join, "VIC", 150)
WA <- adoption_curve_function_states_NOTILL_PA(XYadvisors_postcodes_join, "WA", 128)



NOTill_PA_STATES_adoption_states <- rbind(NSW,SA,VIC,WA)
                                 


```



####Adoption curves for advisor national

```{r adoption curve PA study farmer per national function, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
adoption_curve_function_national <- function(df, numb_farmers) {
  
  count_adoption_year <- count(df,year_as_factor)
  count_adoption_year <- select(count_adoption_year, year = year_as_factor, n)
  years_of_study <- data.frame(year = 1950:2013, 
                               id = 1:64)
                               
  years_of_study <- mutate(years_of_study, year = as.factor(year))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}
```


```{r adoption curve PA study farmer per national, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
#glimpse(XYadvisors_postcodes_join)

advisors_adoption_national <- adoption_curve_function_national(XYadvisors_postcodes_join, 573)


```

```{r plot advisors national, echo=FALSE}

ggplot(advisors_adoption_national, aes(year, cumm_percent))+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2020)+
  ylim(0,100)+
  labs(x = "Years",
       y = "Percentage of farmers and year started paying for agronomic advice")
       
ggsave("Adoption of agronomic advice national.png", width = 9.8, height = 5.6, units = "in")
```

```{r plot advisors national smooth, echo=FALSE}

ggplot(advisors_adoption_national, aes(year, cumm_percent))+
  geom_smooth(se = FALSE, colour = "black")+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2020)+
  ylim(0,100)+
  labs(x = "Years",
       y = "Percentage of farmers and year started paying for agronomic advice")
       
ggsave("Adoption of agronomic advice national smooth check.png", width = 9.8, height = 5.6, units = "in")
```

```{r adoption curve PA study farmer per SLA function, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
adoption_curve_function_SLA <- function(df, zone, numb_farmers) {
  df_subset <- filter(df, region_ReZ == zone)
  count_adoption_year <- count(df_subset,year_as_factor)
  count_adoption_year <- select(count_adoption_year, year = year_as_factor, n)
  years_of_study <- data.frame(year = 1950:2014, 
                               id = 1:65,
                               zone = zone)
  years_of_study <- mutate(years_of_study, year = as.factor(year))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}
```


```{r adoption curve PA study farmer per SLA, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
#glimpse(XYadvisors_postcodes_join)

NSW_Central_West <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "1", 53)
NSW_Riverine_Plains <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "2", 50)
VIC_Mallee <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "3", 52)
VIC_Wimmera <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "4", 51)
VIC_Loddon <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "5", 50)
SA_Mallee <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "6", 50)
SA_Central <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "7", 52)
SA_UpperEP <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "8", 51)
SA_LowerEP <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "9", 36)
WA_Nth_Central <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "11", 36)
WA_Sth_Central <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "12", 47)
WA_Sth <- adoption_curve_function_SLA(XYadvisors_postcodes_join, "13", 45)



advisors_adoption_SLA <- rbind(NSW_Central_West,NSW_Riverine_Plains,VIC_Mallee,VIC_Wimmera,VIC_Loddon,
                                  SA_Mallee,SA_Central, SA_UpperEP, SA_LowerEP, WA_Nth_Central, WA_Sth_Central,WA_Sth)

#Recode the SLA into names from numbers
advisors_adoption_SLA$zone <- ifelse(advisors_adoption_SLA$zone == "1", "NSW Central West",
                                ifelse(advisors_adoption_SLA$zone == "2", "NSW Riverine Plains",
                                ifelse(advisors_adoption_SLA$zone == "3", "VIC Mallee",       
                                ifelse(advisors_adoption_SLA$zone == "4", "VIC Wimmera",       
                                ifelse(advisors_adoption_SLA$zone == "5", "VIC Loddon",
                                ifelse(advisors_adoption_SLA$zone == "6", "SA Mallee",       
                                ifelse(advisors_adoption_SLA$zone == "7", "SA Central",
                                ifelse(advisors_adoption_SLA$zone == "8", "SA UpperEP",       
                                ifelse(advisors_adoption_SLA$zone == "9", "SA LowerEP",
                                ifelse(advisors_adoption_SLA$zone == "11", "WA Nth Central",       
                                ifelse(advisors_adoption_SLA$zone == "12", "WA Sth Central", "WA Sth")))))))))))  

glimpse(advisors_adoption_SLA)
                                       
                              


```

```{r plot advisors SLA, echo=FALSE}

ggplot(advisors_adoption_SLA, aes(year, cumm_percent, colour=zone))+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2015)+
  facet_wrap(.~zone)+
  labs(x = "Years",
       y = "percenatge of farmers",
       title = "Adoption of advisor use per SLA",
       subtitle = "This study has no farmers in QLD")

```






###Step 1 Postcodes data done already 
The below code chuck is to create the postcode file with a only one set of postcodes.

"file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/postcodes_with_coord_dist.csv" 

```{r list_poscodes_with coords weeds, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

postcodes_with_coord <- read.csv("../Australian_Post_Codes_Lat_Lon.csv")

postcodes_with_coord_dist <- distinct(postcodes_with_coord, postcode, .keep_all = TRUE)
write.csv(postcodes_with_coord_dist, "postcodes_with_coord_dist.csv")

```


##Weeds survey - No till dataset




In the Weeds survey Q2a  asks the farmer about zone (I dont have the data for this).
This survey represented the 13 AEZs
Fortunelty we obtained the postcodes for the all the responsdent at a later date.

I have got a cut down version of the dataset that has; 
* KEY 
* POSTCODE
* Q2a 
* Q2aRegion
* Q14_ever_used_no_till_for_cropping
* Q15_year_first_try_no_till


/"file://portjervis-gw/C$/Users/ouz001/book_chapter_data/Weeds/no_till_adoption_curves_R.csv" 




we have no QLD farmers
the study has 602 farmers.
Growers were asked a number of questions about practices but here we have used Q15 to create adoption curves.
In what year did you first try no-till or zero-till for cropping?

Definition of no-till or zero-till That is seeding with no prior cultivation and includes knife points, zero-till
with disc machines, super seeder, inverted-t etc., i.e. not full-cut seeding. 


7.2.1 Cultivation for weed control
Using cultivation to manage weeds is discussed in
Part I, section 3.3.2 ‘Integrated weed management’,
p36. Overall, 71 per cent of growers seeding with
prior cultivation cite weed management as the main
reason for using cultivation (Table 39, p40). While the
proportion of growers using no-till is peaking near
90 per cent, substantial areas are still cultivated and
25 per cent of all growers use some cultivation for
weed management purposes (Table 63, p59).
Cultivation in fallows for the primary purpose of weed
control is most common, particularly in the Northern
region (66 per cent) and Central NSW (Table 64).
Seventy-one percent of growers in Central NSW cultivate
in fallow period on 50 per cent of their cropping land.
The use of cultivation is lowest in the Western region.

Most growers believe that weed costs will be higher
under a no-till system that retains stubble compared
to one based on cultivation, with only 17 per cent
believing costs will be less (Table 65, p60). Almost
half of growers believe the efficacy of pre-emergent
herbicides will be less under no-till stubble retention.
More than half of growers believe that no-till stubble
retention will increase the reliability of wheat yields,
particularly in the Northern region where fallow water
efficiency is of greater importance. Overall, growers also
believe that average crop disease and pest costs will
increase under no-till stubble retention (Table 66, p60).




The weeds study the results are reported by:
regions, Argo ecological zones.

###Step 2 join the postcode data to the weeds survey data

The below code chuck is to join the 'postcodes_with_coord_dist' file to the survey data.
Results are a file called; "file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/NoTill_postcodes.csv" 
which I can use to map.

```{r join list_poscodes_with coords to weeds study, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

#bring in the PA study
NoTill <- read.csv("../Weeds/no_till_adoption_curves_R.csv")

glimpse(NoTill)
NoTill_postcodes1 <- select(NoTill, farmer = KEY,
                            postcode = POSTCODE,
                            Q15_year_first_try_no_till,
                            Q2aRegion
                            ) %>% 
  mutate(study = "NoTill")
glimpse(NoTill_postcodes1)

#join PA study to postcodes
NoTill_postcodes <- left_join(NoTill_postcodes1,
                                  postcodes_with_coord_dist,
                                  by= "postcode")

#I can use this outside of R 
write.csv(NoTill_postcodes, "NoTill_postcodes.csv")
```


### Step 3 map the survey data and create count tables for the zones.


* argoeclogical zones
* regions
* states
* SLA
* regions based on revised GRDC zones (Davids) - not done yet


####step 3a spatial join
Outside of R in Arcmap I have loaded the advisors_postcodes.csv file. "file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/NoTill_postcodes.csv"
and the GRDC shapefile (created by Neil Clark and Assoicates)

"GRDC_AgroEcological_zones_boundaries_06_region"

and run a spatial join creating a new file with the following headings:

* farmer
* postcode
* Q15_year_first_try_no_till
* Q2aRegion
* study
* suburb (not needed)
* state
* dc (not needed)
* type (not needed)
* lat
* lon



"file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/XYNoTill_postcodes_join_GRDC_SLA.csv"



####Step 3b create table

The below code chuck creates tables of number of farmers in weed study per GRDC region 2006.


```{r table of weed study farmer per argozone etc, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}


#read in weed data with postcodes and zones


XYNoTill_postcodes_join <- read.csv("../adoption_data/XYNoTill_postcodes_join_GRDC_SLA.csv")
glimpse(XYNoTill_postcodes_join)


#count the number of farmers in each group
NoTill_n_AGRO <- data.frame(count(XYNoTill_postcodes_join,AGROECOLOG))
NoTill_n_REGIONS <- data.frame(count(XYNoTill_postcodes_join,REGIONS))
NoTill_n_state <- data.frame(count(XYNoTill_postcodes_join,state))
#I dont have these cloumns I can make them but its a lot of work - with no values?
#NoTill_n_GRDC_Regio <- data.frame(count(XYNoTill_postcodes_join,GRDC_Regio))
#NoTill_n_GRDC_region_ReZ <- data.frame(count(XYNoTill_postcodes_join,region_ReZ))
glimpse(advisors_n_GRDC_Regio)

#make the data frames neat and the names consistant (for joining)
NoTill_n_AGRO <- select(NoTill_n_AGRO, zone = AGROECOLOG,
                            number_of_farmers = n) %>% 
                            mutate(grouping = "AGRO")
NoTill_n_REGIONS <- select(NoTill_n_REGIONS, zone = REGIONS,
                            number_of_farmers = n) %>% 
                            mutate(grouping = "REGIONS")
NoTill_n_state <- select(NoTill_n_state, zone = state,
                            number_of_farmers = n) %>% 
                            mutate(grouping = "state")
#Append some of the data
NoTill_n_zones <- rbind(NoTill_n_AGRO,
                          NoTill_n_REGIONS,
                          NoTill_n_state)






datatable(NoTill_n_zones)
#and export the data.
write.csv(NoTill_n_zones, "NoTill_n_zones.csv")
```




Note that in the weed study we used survey company GRDC coding
I have now used postcodes to run spatial join to GRDC agro ecological ploygons
and too the SLA.
The SLA need a lot of work to create grouping like in the PA study.

I am not sure the value in douing this - can be done if needed.

postcodes and SLA2011 (statistical local area - supported for the 2011 census at assist with the transition from ASGC to ASGS).
More infformation here:
http://www.abs.gov.au/websitedbs/censushome.nsf/home/factsheetspoa?opendocument&navpos=450 
I believe I got this from the abs.
It can be found on the shared network here:
"file://FSSA2-ADL/clw-home2/ouz001/PA_Data/Tables%20for%20paper_report/SLA11aAust.dbf"


The below image is a summary of the weeds data and what GRDC zones they fall into.
I have overlayed the SLA as hollow polygons.



![](/Users/ouz001/book_chapter_data/Weed no till with postcodes.png)


### Step 4 create and plot cummulative adoption for weed data no till

Use the joined weed data to generate adoption curves.
"file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/XYNoTill_postcodes_join_GRDC_SLA.csv"

* farmer
* postcode
* Q15_year_f
* Q2aRegion
* study
* suburb (not needed)
* state
* dc (not needed)
* type (not needed)
* lat
* lon
* AGROECOLOG
* REGIONS
* CATCHMENT (not needed)
* SOURCE (not needed)
* STATE_CODE (not needed)
* SLA_CODE11(not needed)
* SLA_NAME11(not needed)
* SLA_5DIGIT(not needed)
* SLA_REG11(not needed)



#####The below code chuck will cal the cummulative adoption data.

```{r adoption curve weed study farmer per argozone function, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

#read in advisor data with postcodes and zones (this was done earlier step)

XYNoTill_postcodes_join <- read.csv("../adoption_data/XYNoTill_postcodes_join_GRDC_SLA.csv")

#change the year from interger to factor
XYNoTill_postcodes_join <- mutate(XYNoTill_postcodes_join, year_as_factor = as.factor(Q15_year_f))
#glimpse(XYNoTill_postcodes_join)

#make a function to generate cummulative data
#my df needs to have a clm called 'AGROECOLOG' and 'year_as_factor'
#the zones need to come out of the 'AGROECOLOG' and I need to have number of farmers in this zone


adoption_curve_function_NoTill <- function(df, zone, numb_farmers) {
  df_subset <- filter(df, AGROECOLOG == zone)
  count_adoption_year <- count(df_subset,year_as_factor)
  count_adoption_year <- select(count_adoption_year, year = year_as_factor, n)
  years_of_study <- data.frame(year = 1950:2014, 
                               id = 1:65,
                               zone = zone)
  years_of_study <- mutate(years_of_study, year = as.factor(year))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}


```


#### Weeds Survey data for No till adoption for agroecological zone
adoption_curve_function_NoTill
XYNoTill_postcodes_join
 



```{r adoption curve weeds study farmer per argozone etc, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}



Qld_Central_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "Qld Central", 26)
NSW_NorthEast_Qld_SouthEast_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "NSW NorthEast-Qld SouthEast", 50)

NSW_NorthWest_Qld_SouthWest_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "NSW NorthWest-Qld SouthWest", 42)

NSW_Central_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "NSW Central", 71)
NSW_Vic_Slopes_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "NSW Vic Slopes", 31)

SA_Midnorth_Lower_Yorke_Eyre_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "SA Midnorth-Lower Yorke Eyre", 52)
SA_Vic_Bordertown_Wimmera_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "SA Vic Bordertown-Wimmera", 59)
SA_Vic_Mallee_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "SA Vic Mallee", 48)

Vic_High_Rainfall_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "Vic High Rainfall", 32)
Tas_Grain_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "Tas Grain", 5)

WA_Central_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "WA Central", 45)
WA_Eastern_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "WA Eastern", 47)
WA_Mallee_Sandplain_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "WA Mallee and Sandplain", 40)
WA_Northern_NT <- adoption_curve_function_NoTill(XYNoTill_postcodes_join, "WA Northern", 40)

NoTill_adoption_Agro_NT <- rbind(Qld_Central_NT, NSW_NorthEast_Qld_SouthEast_NT, NSW_NorthWest_Qld_SouthWest_NT,
                          NSW_Central_NT,NSW_Vic_Slopes_NT,
                          SA_Midnorth_Lower_Yorke_Eyre_NT,SA_Vic_Bordertown_Wimmera_NT,SA_Vic_Mallee_NT,
                                Vic_High_Rainfall_NT,Tas_Grain_NT,
                                WA_Central_NT,WA_Eastern_NT,WA_Mallee_Sandplain_NT,WA_Northern_NT) 



```


```{r plot NoTill Agro, echo=FALSE}

ggplot(NoTill_adoption_Agro_NT, aes(year, cumm_percent, group=zone))+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2015)+
  facet_wrap(.~zone)+
  labs(x = "Years",
       y = "Percenatge of farmers")#,
       #title = "Adoption of no till use per AgroEcological")
ggsave("NoTill_adoption_Agro_NT.png")

```


```{r adoption curve weed study farmer per region function, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}




adoption_curve_function_NoTill_R <- function(df, zone, numb_farmers) {
  df_subset <- filter(df, REGIONS == zone)
  count_adoption_year <- count(df_subset,year_as_factor)
  count_adoption_year <- select(count_adoption_year, year = year_as_factor, n)
  years_of_study <- data.frame(year = 1950:2014, 
                               id = 1:65,
                               zone = zone)
  years_of_study <- mutate(years_of_study, year = as.factor(year))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}


```

```{r adoption curve weeds study farmer per regions etc, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
glimpse(XYNoTill_postcodes_join)
Northern_NT <- adoption_curve_function_NoTill_R(XYNoTill_postcodes_join, "Northern", 118)
Southern_NT <- adoption_curve_function_NoTill_R(XYNoTill_postcodes_join, "Southern", 298)
Western_NT <- adoption_curve_function_NoTill_R(XYNoTill_postcodes_join, "Western", 172)

NoTill_adoption_Region_NT <- rbind(Northern_NT, Southern_NT, Western_NT) 



```

```{r plot NoTill region facet wrap, echo=FALSE}

ggplot(NoTill_adoption_Region_NT, aes(year, cumm_percent, group = zone))+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2015)+
  facet_wrap(.~zone)+
  labs(x = "Years",
       y = "percenatge of farmers",
       title = "Adoption of no till use per Region")

```

# adoption of no till national 

```{r adoption curve weed study farmer national function, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}




adoption_curve_function_NoTill_national <- function(df, numb_farmers) {
  
  count_adoption_year <- count(df,year_as_factor)
  count_adoption_year <- select(count_adoption_year, year = year_as_factor, n)
  years_of_study <- data.frame(year = 1950:2014, 
                               id = 1:65)
  years_of_study <- mutate(years_of_study, year = as.factor(year))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}


```

```{r adoption curve weeds study farmer national, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

National_NT <- adoption_curve_function_NoTill_national(XYNoTill_postcodes_join,  602)

#glimpse(XYNoTill_postcodes_join)

```


```{r plot NoTill national , echo=FALSE}

ggplot(National_NT, aes(year, cumm_percent))+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2020)+
  ylim(0,100)+
  labs(x = "Years",
       y = "Percentage of farmers in year first trying no-till")
       

ggsave("Adoption of no till use national.png", width = 9.8, height = 5.6, units = "in")

```


```{r plot NoTill national smooth , echo=FALSE}

ggplot(National_NT, aes(year, cumm_percent))+
  geom_smooth(se=FALSE, colour = "black")+
  #geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2020)+
  ylim(0,100)+
  labs(x = "Years",
       y = "Percentage of farmers in year first trying no-till")
       

ggsave("Adoption of no till use national smooth.png", width = 9.8, height = 5.6, units = "in")

```



```{r plot NoTill region overlayed, echo=FALSE}

ggplot(NoTill_adoption_Region_NT, aes(year, cumm_percent, group = zone))+
  #geom_line(aes(linetype = zone))+
  geom_line(aes(linetype=zone))+
  theme_classic()+
  theme(legend.position = "bottom")+
 
  xlim(1980, 2015)+
  labs(x = "Years",
       y = "Percenatge of farmers" )
       #title = "Adoption of no till use per Region")
ggsave("NoTill_adoption_Region.png")

```






```{r adoption curve weed study farmer per state function, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}




adoption_curve_function_NoTill_S <- function(df, zone, numb_farmers) {
  df_subset <- filter(df, state == zone)
  count_adoption_year <- count(df_subset,year_as_factor)
  count_adoption_year <- select(count_adoption_year, year = year_as_factor, n)
  years_of_study <- data.frame(year = 1950:2014, 
                               id = 1:65,
                               zone = zone)
  years_of_study <- mutate(years_of_study, year = as.factor(year))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}


```


```{r adoption curve weeds study farmer per state etc, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}

QLD_NT <- adoption_curve_function_NoTill_S(XYNoTill_postcodes_join, "QLD", 59)
NSW_NT <- adoption_curve_function_NoTill_S(XYNoTill_postcodes_join, "NSW", 153)
SA_NT <- adoption_curve_function_NoTill_S(XYNoTill_postcodes_join, "SA", 65)
VIC_NT <- adoption_curve_function_NoTill_S(XYNoTill_postcodes_join, "VIC", 141)
WA_NT <- adoption_curve_function_NoTill_S(XYNoTill_postcodes_join, "WA", 179)



NoTill_adoption_state_NT <- rbind(QLD_NT, NSW_NT, SA_NT,VIC_NT, WA_NT ) 



```

```{r plot NoTill state, echo=FALSE}

ggplot(NoTill_adoption_state_NT, aes(year, cumm_percent, colour=zone))+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2015)+
  facet_wrap(.~zone)+
  labs(x = "Years",
       y = "percenatge of farmers",
       title = "Adoption of no till use per state")

```


## Step 5 join the datasets together


```{r no till and advisor data by agro, echo=FALSE}



NoTill_adoption_Agro_NT <- mutate(NoTill_adoption_Agro_NT, practice = "no_till")
#glimpse(NoTill_adoption_Agro_NT)
advisors_adoption_Agro <- mutate(advisors_adoption_Agro, practice = "Advisor")

#glimpse(advisors_adoption_Agro)

no_till_advisors_Agro <- rbind(NoTill_adoption_Agro_NT, advisors_adoption_Agro)

ggplot(no_till_advisors_Agro, aes(year, cumm_percent, group=practice))+
  geom_line(aes(linetype=practice))+
  #geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2015)+
  facet_wrap(.~zone)+
  labs(x = "Years",
       y = "percenatge of farmers")
       #,
       #title = "Adoption of no till and advisor use per Agroecological zones")
ggsave("Adoption_no_till_and_advisor_use_Agroecological.png")

```

```{r no till and advisor data by regions, echo=FALSE}



NoTill_adoption_Region_NT <- mutate(NoTill_adoption_Region_NT, practice = "no_till")

advisors_adoption_REGIONS <- mutate(advisors_adoption_REGIONS, practice = "Advisor")



no_till_advisors_REGIONS <- rbind(NoTill_adoption_Region_NT, advisors_adoption_REGIONS)


no_till_advisors_REGIONS_NthEx <- filter(no_till_advisors_REGIONS, zone != "Northern")

ggplot(no_till_advisors_REGIONS_NthEx, aes(year, cumm_percent, group=practice))+
  geom_line(aes(linetype=practice))+
  #geom_line()+
  theme_classic()+
  theme(legend.position = "none")+
  #theme(legend.position = "bottom")+
  xlim(1980, 2020)+
  #facet_grid(zone~.)+
  facet_wrap(zone~.)+
  labs(x = "Years",
       y = "Percentage of farmers")
       #,
       #title = "Adoption of no till and advisor use per regions")
ggsave("Adoption_no_till_and_advisor_use_regions_facet_wrap.png", width = 9.8, height = 5.6, units = "in")



```



```{r no till and advisor data national, echo=FALSE}



National_NT <- mutate(National_NT, practice = "no_till")

advisors_adoption_national <- mutate(advisors_adoption_national, practice = "Advisor")



no_till_advisors_national <- rbind(National_NT, advisors_adoption_national)

write.csv(no_till_advisors_national, "no_till_advisors_national.csv")

ggplot(no_till_advisors_national, aes(year, cumm_percent, group=practice))+
  geom_line(aes(linetype=practice))+
  #geom_line()+
  theme_classic()+
  theme(legend.position = "none")+
  #theme(legend.position = "bottom")+
  xlim(1980, 2020)+
  ylim(0,100)+
  
  labs(x = "Years",
       y = "Percentage of farmers")
       
ggsave("Adoption_no_till_and_advisor_use_national.png", width = 9.8, height =  5.6, units = "in")

```

```{r no till and advisor data national smooth line, echo=FALSE}



ggplot(no_till_advisors_national, aes(year, cumm_percent, group=practice))+
  geom_smooth(se = FALSE, colour = "black", aes(linetype=practice))+
  theme_classic()+
  theme(legend.position = "none")+
  xlim(1980, 2020)+
  ylim(0,100)+
  
  labs(x = "Years",
       y = "Percentage of farmers")
       
ggsave("Adoption_no_till_and_advisor_use_national_smooth.png", width = 9.8, height =  5.6, units = "in")

```


```{r no till and advisor data by states, echo=FALSE}



NoTill_adoption_state_NT <- mutate(NoTill_adoption_state_NT, practice = "no_till")

advisors_adoption_states <- mutate(advisors_adoption_states, practice = "Advisor")



no_till_advisors_states <- rbind(NoTill_adoption_state_NT, advisors_adoption_states)

no_till_advisors_states_QLD_Ex <- filter(no_till_advisors_states, zone != "QLD")

ggplot(no_till_advisors_states_QLD_Ex, aes(year, cumm_percent, group=practice))+
  geom_line(aes(linetype=practice))+
  theme_classic()+
  #theme(legend.position = "bottom")+
  theme(legend.position = "none")+
  xlim(1980, 2020)+
  facet_wrap(.~zone)+
  #facet_grid(zone~.)+
  labs(x = "Years",
       y = "Percentage of farmers")
      


ggsave("Adoption of no till and advisor use per states 1980.png" , width = 9.8, height = 5.6, units = "in")



```




#Cultivation data

Joined it to file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/NoTill_postcodes.csv
based on postcodes 

I have used the raw data (because it has postcodes) and removed a number of coloumns.
Hopefully retaining what I need;

"file://FSSA2-ADL/clw-share1/Microlab/Weeds/Farmer_Survey/Weed%20in%20Crops%20Study_postcodes_updated8-7-14_Curves.xlsx" (I think its this file - first tab)

* Q16_ 1 
* Q19
* Q20b
* Q11
* Q11a

Average percentage of growers cultivating cropping land prior to or at seeding (i.e. not under no-till).

This is question 16_1 For the crop area that you will sow this year, what percentage will be sown using…No till or zero till (ie seeding with discs or knife points with no prior cultivation)
I have reported counts of growers who indicate that they have 0 proportion of land with ‘no till’ 
Then I have express as % of all growers 
South = 46 growers greater than zero /305 =15%

##Average % of growers cultivating cropping land prior to or at seeding (ie not under no till)


```{r Cultivation prior to seeding state, echo=FALSE}
#bring in the cultivation data with zone info merged 
cultivation_prior_seeding <- read.csv("../Weeds/cultivation.csv")

#glimpse(cultivation_prior_seeding)

count_cultivation_prior_seeding_national <- count(cultivation_prior_seeding,Q16_1==0) %>% 
  mutate(zone = "national",
         cultivation = as.double(`Q16_1 == 0`)) %>% 
  select(zone,cultivation, n )

test_national <- filter(count_cultivation_prior_seeding_national, count_cultivation_prior_seeding_national$cultivation ==1)
test2_national <- (test_national$n/(sum(count_cultivation_prior_seeding_national$n))*100)
                
cultivation_percent_national = data.frame(percentage = test2_national) %>% 
  mutate(zone = "national")

#####STATE#####

count_cultivation_prior_seeding_state <- group_by(cultivation_prior_seeding, state) %>% 
count(Q16_1==0) %>% 
mutate(zone = "state",
         cultivation = as.double(`Q16_1 == 0`)) %>% 
  select(zone,cultivation, n )
#glimpse(count_cultivation_prior_seeding_state)


##NOW make df for each state
####SA###
test_state_SA <- filter(count_cultivation_prior_seeding_state, state =="SA" )
 test_state_SA_n <- sum(test_state_SA$n)                       
#glimpse(test_state_SA_n)
test_state_SA_cult <- filter(test_state_SA, count_cultivation_prior_seeding_national$cultivation ==1)
#glimpse(test_state_SA_cult)
cultivation_percent_SA = data.frame(percentage = (test_state_SA_cult$n / test_state_SA_n)*100) %>% 
  mutate(zone = "SA")
##NSW###
test_state_NSW <- filter(count_cultivation_prior_seeding_state, state =="NSW" )
 test_state_NSW_n <- sum(test_state_NSW$n)                       
test_state_NSW_cult <- filter(test_state_NSW, count_cultivation_prior_seeding_national$cultivation ==1)
cultivation_percent_NSW = data.frame(percentage = (test_state_NSW_cult$n / test_state_NSW_n)*100) %>% 
  mutate(zone = "NSW")
##VIC###
test_state_VIC <- filter(count_cultivation_prior_seeding_state, state =="VIC" )
 test_state_VIC_n <- sum(test_state_VIC$n)                       
test_state_VIC_cult <- filter(test_state_VIC, count_cultivation_prior_seeding_national$cultivation ==1)
cultivation_percent_VIC = data.frame(percentage = (test_state_VIC_cult$n / test_state_VIC_n)*100) %>% 
  mutate(zone = "VIC")
##QLD###
test_state_QLD <- filter(count_cultivation_prior_seeding_state, state =="QLD" )
 test_state_QLD_n <- sum(test_state_QLD$n)                       
test_state_QLD_cult <- filter(test_state_QLD, count_cultivation_prior_seeding_national$cultivation ==1)
cultivation_percent_QLD = data.frame(percentage = (test_state_QLD_cult$n / test_state_QLD_n)*100) %>% 
  mutate(zone = "QLD")
##WA###
test_state_WA <- filter(count_cultivation_prior_seeding_state, state =="WA" )
 test_state_WA_n <- sum(test_state_WA$n)                       
test_state_WA_cult <- filter(test_state_WA, count_cultivation_prior_seeding_national$cultivation ==1)
cultivation_percent_WA = data.frame(percentage = (test_state_WA_cult$n / test_state_WA_n)*100) %>% 
  mutate(zone = "WA")
test_state <- rbind(cultivation_percent_SA, cultivation_percent_NSW, cultivation_percent_VIC, cultivation_percent_QLD,cultivation_percent_WA)
##TAS###
test_state_TAS <- filter(count_cultivation_prior_seeding_state, state =="TAS" )
 test_state_TAS_n <- sum(test_state_TAS$n)                       
test_state_TAS_cult <- filter(test_state_TAS, count_cultivation_prior_seeding_national$cultivation ==1)
cultivation_percent_TAS = data.frame(percentage = (test_state_TAS_cult$n / test_state_TAS_n)*100) %>% 
  mutate(zone = "TAS")


percentage_cultivation_state <-  rbind(cultivation_percent_SA, cultivation_percent_NSW, cultivation_percent_VIC, cultivation_percent_QLD,cultivation_percent_WA, cultivation_percent_TAS)
percentage_cultivation_state$percentage <-  round(percentage_cultivation_state$percentage, 0)

library(DT)
datatable(percentage_cultivation_state, colnames = c('ID' = 1), caption = "average percentage of growers culitivating prior to seeding")



```

AGROECOLOG 


```{r Cultivation prior to seeding AGROECOLOG, echo=FALSE}

#####AGROECOLOG#####

count_cultivation_prior_seeding_AGROECOLOG <- group_by(cultivation_prior_seeding, AGROECOLOG) %>% 
count(Q16_1==0) %>% 
mutate(zone = "AGROECOLOG",
         cultivation = as.double(`Q16_1 == 0`)) %>% 
  select(zone,cultivation, n )
glimpse(count_cultivation_prior_seeding_AGROECOLOG)


##NOW make df for each AGROECOLOG
####NSW Central###
AGROECOLOG_NSW_Central <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="NSW Central" )
AGROECOLOG_NSW_Central_n <- sum(AGROECOLOG_NSW_Central$n)                       
AGROECOLOG_NSW_Central_cult <- filter(AGROECOLOG_NSW_Central, AGROECOLOG_NSW_Central$cultivation ==1)
cultivation_percent_NSW_Central = data.frame(percentage = (AGROECOLOG_NSW_Central_cult$n / AGROECOLOG_NSW_Central_n)*100) %>% 
  mutate(zone = "NSW_Central")


##NSW_NorthEast_Qld_SouthEast###
AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="NSW NorthEast-Qld SouthEast" )
AGROECOLOG_NSW_NorthEast_Qld_SouthEast_n <- sum(AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n)                       
AGROECOLOG_NSW_NorthEast_Qld_SouthEast_cult <- filter(AGROECOLOG_NSW_NorthEast_Qld_SouthEast, AGROECOLOG_NSW_NorthEast_Qld_SouthEast$cultivation ==1)
cultivation_percent_NSW_NorthEast_Qld_SouthEast = data.frame(percentage = (AGROECOLOG_NSW_NorthEast_Qld_SouthEast_cult$n / AGROECOLOG_NSW_NorthEast_Qld_SouthEast_n)*100) %>% 
  mutate(zone = "NSW_NorthEast_Qld_SouthEast")


##NSW_NorthWest_Qld_SouthWest###
AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="NSW NorthWest-Qld SouthWest" )
AGROECOLOG_NSW_NorthWest_Qld_SouthWest_n <- sum(AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n)                       
AGROECOLOG_NSW_NorthWest_Qld_SouthWest_cult <- filter(AGROECOLOG_NSW_NorthWest_Qld_SouthWest, AGROECOLOG_NSW_NorthWest_Qld_SouthWest$cultivation ==1)
cultivation_percent_NSW_NorthWest_Qld_SouthWest = data.frame(percentage = (AGROECOLOG_NSW_NorthWest_Qld_SouthWest_cult$n / AGROECOLOG_NSW_NorthWest_Qld_SouthWest_n)*100) %>% 
  mutate(zone = "NSW_NorthWest_Qld_SouthWest")

##NSW_Vic_Slopes###
AGROECOLOG_NSW_Vic_Slopes <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="NSW Vic Slopes" )
AGROECOLOG_NSW_Vic_Slopes_n <- sum(AGROECOLOG_NSW_Vic_Slopes$n)                       
AGROECOLOG_NSW_Vic_Slopes_cult <- filter(AGROECOLOG_NSW_Vic_Slopes, AGROECOLOG_NSW_Vic_Slopes$cultivation ==1)
cultivation_percent_NSW_Vic_Slopes = data.frame(percentage = (AGROECOLOG_NSW_Vic_Slopes_cult$n / AGROECOLOG_NSW_Vic_Slopes_n)*100) %>% 
  mutate(zone = "NSW_Vic_Slopes")

##Qld_Central###
AGROECOLOG_Qld_Central <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="Qld Central" )
AGROECOLOG_Qld_Central_n <- sum(AGROECOLOG_Qld_Central$n)                       
AGROECOLOG_Qld_Central_cult <- filter(AGROECOLOG_Qld_Central, AGROECOLOG_Qld_Central$cultivation ==1)
cultivation_percent_Qld_Central = data.frame(percentage = (AGROECOLOG_Qld_Central_cult$n / AGROECOLOG_Qld_Central_n)*100) %>% 
  mutate(zone = "Qld_Central")

##SA_Midnorth_Lower_Yorke_Eyre###
AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="SA Midnorth-Lower Yorke Eyre" )
AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre_n <- sum(AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n)                       
AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre_cult <- filter(AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$cultivation ==1)
cultivation_percent_SA_Midnorth_Lower_Yorke_Eyre = data.frame(percentage = (AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre_cult$n / AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre_n)*100) %>% 
  mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre")

##SA_Vic_Bordertown_Wimmera###
AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="SA Vic Bordertown-Wimmera" )
AGROECOLOG_SA_Vic_Bordertown_Wimmera_n <- sum(AGROECOLOG_SA_Vic_Bordertown_Wimmera$n)                       
AGROECOLOG_SA_Vic_Bordertown_Wimmera_cult <- filter(AGROECOLOG_SA_Vic_Bordertown_Wimmera, AGROECOLOG_SA_Vic_Bordertown_Wimmera$cultivation ==1)
cultivation_percent_SA_Vic_Bordertown_Wimmera = data.frame(percentage = (AGROECOLOG_SA_Vic_Bordertown_Wimmera_cult$n / AGROECOLOG_SA_Vic_Bordertown_Wimmera_n)*100) %>% 
  mutate(zone = "SA_Vic_Bordertown_Wimmera")

##SA_Vic_Mallee###
AGROECOLOG_SA_Vic_Mallee <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="SA Vic Mallee" )
AGROECOLOG_SA_Vic_Mallee_n <- sum(AGROECOLOG_SA_Vic_Mallee$n)                       
AGROECOLOG_SA_Vic_Mallee_cult <- filter(AGROECOLOG_SA_Vic_Mallee, AGROECOLOG_SA_Vic_Mallee$cultivation ==1)
cultivation_percent_SA_Vic_Mallee = data.frame(percentage = (AGROECOLOG_SA_Vic_Mallee_cult$n / AGROECOLOG_SA_Vic_Mallee_n)*100) %>% 
  mutate(zone = "SA_Vic_Mallee")
glimpse(cultivation_percent_SA_Vic_Mallee)

##Tas_Grain###
AGROECOLOG_Tas_Grain <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="Tas Grain" )
glimpse(AGROECOLOG_Tas_Grain)
AGROECOLOG_Tas_Grain_n <- sum(AGROECOLOG_Tas_Grain$n)
#glimpse(AGROECOLOG_Tas_Grain_n)
AGROECOLOG_Tas_Grain_cult <- filter(AGROECOLOG_Tas_Grain, AGROECOLOG_Tas_Grain$cultivation ==1)
#glimpse(AGROECOLOG_Tas_Grain_cult)
cultivation_percent_Tas_Grain = data.frame(percentage = (AGROECOLOG_Tas_Grain_cult$n / AGROECOLOG_Tas_Grain_n)*100) %>% 
  mutate(zone = "Tas_Grain")
glimpse(cultivation_percent_Tas_Grain)

##Vic_High_Rainfall###
AGROECOLOG_Vic_High_Rainfall <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="Vic High Rainfall" )
AGROECOLOG_Vic_High_Rainfall_n <- sum(AGROECOLOG_Vic_High_Rainfall$n)                       
AGROECOLOG_Vic_High_Rainfall_cult <- filter(AGROECOLOG_Vic_High_Rainfall, AGROECOLOG_Vic_High_Rainfall$cultivation ==1)
cultivation_percent_Vic_High_Rainfall = data.frame(percentage = (AGROECOLOG_Vic_High_Rainfall_cult$n  / AGROECOLOG_Vic_High_Rainfall_n)*100) %>% 
  mutate(zone = "Vic_High_Rainfall")

##WA_Central###
AGROECOLOG_WA_Central <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="WA Central" )
AGROECOLOG_WA_Central_n <- sum(AGROECOLOG_WA_Central$n)                       
AGROECOLOG_WA_Central_cult <- filter(AGROECOLOG_WA_Central, AGROECOLOG_WA_Central$cultivation ==1)
cultivation_percent_WA_Central = data.frame(percentage = (AGROECOLOG_WA_Central_cult$n  / AGROECOLOG_WA_Central_n)*100) %>% 
  mutate(zone = "WA_Central")

##WA_Eastern###
AGROECOLOG_WA_Eastern <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="WA Eastern" )
AGROECOLOG_WA_Eastern_n <- sum(AGROECOLOG_WA_Eastern$n)                       
AGROECOLOG_WA_Eastern_cult <- filter(AGROECOLOG_WA_Eastern, AGROECOLOG_WA_Eastern$cultivation ==1)
cultivation_percent_WA_Eastern = data.frame(percentage = (AGROECOLOG_WA_Eastern_cult$n  / AGROECOLOG_WA_Eastern_n)*100) %>% 
  mutate(zone = "WA_Eastern")


##WA_Mallee_Sandplain###
AGROECOLOG_WA_Mallee_Sandplain <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="WA Mallee and Sandplain" )
AGROECOLOG_WA_Mallee_Sandplain_n <- sum(AGROECOLOG_WA_Mallee_Sandplain$n)                       
AGROECOLOG_WA_Mallee_Sandplain_cult <- filter(AGROECOLOG_WA_Mallee_Sandplain, AGROECOLOG_WA_Mallee_Sandplain$cultivation ==1)
cultivation_percent_WA_Mallee_Sandplain = data.frame(percentage = (AGROECOLOG_WA_Mallee_Sandplain_cult$n  / AGROECOLOG_WA_Mallee_Sandplain_n)*100) %>% 
  mutate(zone = "WA_Mallee_Sandplain")

##WA_Northern###
AGROECOLOG_WA_Northern <- filter(count_cultivation_prior_seeding_AGROECOLOG, AGROECOLOG =="WA Northern" )
AGROECOLOG_WA_Northern_n <- sum(AGROECOLOG_WA_Northern$n)                       
AGROECOLOG_WA_Northern_cult <- filter(AGROECOLOG_WA_Northern, AGROECOLOG_WA_Northern$cultivation ==1)
cultivation_percent_WA_Northern = data.frame(percentage = (AGROECOLOG_WA_Northern_cult$n  / AGROECOLOG_WA_Northern_n)*100) %>% 
  mutate(zone = "WA_Northern")

percentage_cultivation_AGROECOLOG <-  rbind(cultivation_percent_NSW_Central,
                                            cultivation_percent_NSW_NorthEast_Qld_SouthEast,
                                            cultivation_percent_NSW_NorthWest_Qld_SouthWest,
                                            cultivation_percent_NSW_Vic_Slopes,
                                            cultivation_percent_Qld_Central,
                                            cultivation_percent_SA_Midnorth_Lower_Yorke_Eyre,
                                            cultivation_percent_SA_Vic_Bordertown_Wimmera,
                                            cultivation_percent_SA_Vic_Mallee,
                                            cultivation_percent_Tas_Grain,
                                            cultivation_percent_Vic_High_Rainfall,
                                            cultivation_percent_WA_Central,
                                            cultivation_percent_WA_Eastern,
                                            cultivation_percent_WA_Mallee_Sandplain,
                                            cultivation_percent_WA_Northern)


percentage_cultivation_AGROECOLOG$percentage <-  round(percentage_cultivation_AGROECOLOG$percentage, 0)

glimpse(percentage_cultivation_AGROECOLOG)
datatable(percentage_cultivation_AGROECOLOG, colnames = c('ID' = 1), caption = "average percentage of growers culitivating prior to seeding")
```


REGIONS 


```{r Cultivation prior to seeding REGIONS, echo=FALSE}

#####REGIONS#####

count_cultivation_prior_seeding_REGIONS <- group_by(cultivation_prior_seeding, REGIONS) %>% 
count(Q16_1==0) %>% 
mutate(zone = "REGIONS",
         cultivation = as.double(`Q16_1 == 0`)) %>% 
  select(zone,cultivation, n )
glimpse(count_cultivation_prior_seeding_REGIONS)


##NOW make df for each REGIONS
####Northern###
REGION_Northern <- filter(count_cultivation_prior_seeding_REGIONS, REGIONS =="Northern" )
REGION_Northern_n <- sum(REGION_Northern$n)                       
REGION_Northern_cult <- filter(REGION_Northern, REGION_Northern$cultivation ==1)
cultivation_percent_Northern = data.frame(percentage = (REGION_Northern_cult$n / REGION_Northern_n)*100) %>% 
  mutate(zone = "Northern")

####Southern###
REGION_Southern <- filter(count_cultivation_prior_seeding_REGIONS, REGIONS =="Southern" )
REGION_Southern_n <- sum(REGION_Southern$n)                       
REGION_Southern_cult <- filter(REGION_Southern, REGION_Southern$cultivation ==1)
cultivation_percent_Southern = data.frame(percentage = (REGION_Southern_cult$n / REGION_Southern_n)*100) %>% 
  mutate(zone = "Southern")

####Western###
REGION_Western <- filter(count_cultivation_prior_seeding_REGIONS, REGIONS =="Western" )
REGION_Western_n <- sum(REGION_Western$n)                       
REGION_Western_cult <- filter(REGION_Western, REGION_Western$cultivation ==1)
cultivation_percent_Western = data.frame(percentage = (REGION_Western_cult$n / REGION_Western_n)*100) %>% 
  mutate(zone = "Western")

percentage_cultivation_REGIONS <-  rbind(cultivation_percent_Northern,
                                            cultivation_percent_Southern,
                                            cultivation_percent_Western)


percentage_cultivation_REGIONS$percentage <-  round(percentage_cultivation_REGIONS$percentage, 0)

library(DT)
datatable(percentage_cultivation_REGIONS, colnames = c('ID' = 1), caption = "average percentage of growers culitivating prior to seeding")
```

##Merge all the percentage tables togther.

* percentage_cultivation_state
* percentage_cultivation_REGIONS
* percentage_cultivation_AGROECOLOG

```{r Cultivation prior to seeding states REGIONS AGRO, echo=FALSE}




percentage_cultivation_all <-  rbind(percentage_cultivation_state,
                                            percentage_cultivation_REGIONS,
                                            percentage_cultivation_AGROECOLOG)

datatable(percentage_cultivation_all, colnames = c('ID' = 1), caption = "average percentage of growers cultivating prior to seeding")
```

##Average % of growers who cite weed management as the main reason for cultivation prior to seeding (as a proportionn of all growers)


```{r main reason for cultivation prior to seeding state , echo=FALSE}
#bring in the cultivation data with zone info merged 
#cultivation_prior_seeding <- read.csv("../Weeds/cultivation.csv")

glimpse(cultivation_prior_seeding)

#Make a data set that has Q19 coded as main 'reason' 1 
reason_cult <- select(cultivation_prior_seeding,
                state, AGROECOLOG, REGIONS, Q19) %>% 
  mutate(reason = if_else(cultivation_prior_seeding$Q19 != -99 & cultivation_prior_seeding$Q19 > 4, "1", "0" ))



###NATIONAL ####
count_reason_cult_national <- count(reason_cult, reason == 1)  %>% 
                              mutate(zone = "national",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_national <- filter(count_reason_cult_national, count_reason_cult_national$reason_cult ==1)
#glimpse(reason_national)

reason_national_test <- (reason_national$n/(sum(count_reason_cult_national$n))*100)
#glimpse(reason_national_test) 


reason_cult_percent_national = data.frame(percentage = reason_national_test) %>% 
  mutate(zone = "national")
#glimpse(reason_cult_percent_national)

####BY STATES####
##NOW make df for each state
####SA###
reason_state_SA <- filter(reason_cult, state =="SA")
count_reason_state_SA <- count(reason_state_SA, reason == 1)  %>% 
                              mutate(zone = "SA",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )

reason_state_SA <- filter(count_reason_state_SA, count_reason_state_SA$reason_cult ==1)
cult_reason_percent_SA = data.frame(percentage = (reason_state_SA$n / (sum(count_reason_state_SA$n))*100)) %>% 
  mutate(zone = "SA")


####VIC###
reason_state_VIC <- filter(reason_cult, state =="VIC")
count_reason_state_VIC <- count(reason_state_VIC, reason == 1)  %>% 
                              mutate(zone = "VIC",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )

reason_state_VIC <- filter(count_reason_state_VIC, count_reason_state_VIC$reason_cult ==1)
cult_reason_percent_VIC = data.frame(percentage = (reason_state_VIC$n / (sum(count_reason_state_VIC$n))*100)) %>% 
  mutate(zone = "VIC")

####QLD###
reason_state_QLD <- filter(reason_cult, state =="QLD")
count_reason_state_QLD <- count(reason_state_QLD, reason == 1)  %>% 
                              mutate(zone = "QLD",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )

reason_state_QLD <- filter(count_reason_state_QLD, count_reason_state_QLD$reason_cult ==1)
cult_reason_percent_QLD = data.frame(percentage = (reason_state_QLD$n / (sum(count_reason_state_QLD$n))*100)) %>% 
  mutate(zone = "QLD")



####NSW###
reason_state_NSW <- filter(reason_cult, state =="NSW")
count_reason_state_NSW <- count(reason_state_NSW, reason == 1)  %>% 
                              mutate(zone = "NSW",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )

reason_state_NSW <- filter(count_reason_state_NSW, count_reason_state_NSW$reason_cult ==1)
cult_reason_percent_NSW = data.frame(percentage = (reason_state_NSW$n / (sum(count_reason_state_NSW$n))*100)) %>% 
  mutate(zone = "NSW")

####WA###
reason_state_WA <- filter(reason_cult, state =="WA")
count_reason_state_WA <- count(reason_state_WA, reason == 1)  %>% 
                              mutate(zone = "WA",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )

reason_state_WA <- filter(count_reason_state_WA, count_reason_state_WA$reason_cult ==1)
cult_reason_percent_WA = data.frame(percentage = (reason_state_WA$n / (sum(count_reason_state_WA$n))*100)) %>% 
  mutate(zone = "WA")

####TAS###
reason_state_TAS <- filter(reason_cult, state =="TAS")
count_reason_state_TAS <- count(reason_state_TAS, reason == 1)  %>% 
                              mutate(zone = "TAS",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )

reason_state_TAS <- filter(count_reason_state_TAS, count_reason_state_TAS$reason_cult ==1)
cult_reason_percent_TAS = data.frame(percentage = (reason_state_TAS$n / (sum(count_reason_state_TAS$n))*100)) %>% 
  mutate(zone = "TAS")

reason_cult_state <- rbind(cult_reason_percent_NSW,
                           cult_reason_percent_QLD,
                           cult_reason_percent_SA,
                           cult_reason_percent_VIC,
                           cult_reason_percent_WA,
                           cult_reason_percent_TAS)  
reason_cult_state$percentage <- round(reason_cult_state$percentage,digits = 0)


```


```{r main reason for cultivation prior to seeding agro , echo=FALSE}
#bring in the cultivation data with zone info merged 
#cultivation_prior_seeding <- read.csv("../Weeds/cultivation.csv")



#Make a data set that has Q19 coded as main 'reason' 1 
reason_cult <- select(cultivation_prior_seeding,
                state, AGROECOLOG, REGIONS, Q19) %>% 
  mutate(reason = if_else(cultivation_prior_seeding$Q19 != -99 & cultivation_prior_seeding$Q19 > 4, "1", "0" ))

glimpse(reason_cult)



####BY AGROECOLOG####
##NOW make df for each AGROECOLOG
##NSW Central
##NSW NorthEast-Qld SouthEast
##NSW NorthWest-Qld SouthWest
##NSW Vic Slopes
##Qld Central
##SA Midnorth-Lower Yorke Eyre
##SA Vic Bordertown-Wimmera
##SA Vic Mallee
##Tas Grain
##Vic High Rainfall
##WA Central
##WA Eastern
##WA Mallee and Sandplain
##WA Northern

####x###
reason_AGROECOLOG_x <- filter(reason_cult, AGROECOLOG =="x")
count_reason_AGROECOLOG_x <- count(reason_AGROECOLOG_x, reason == 1)  %>% 
                              mutate(zone = "x",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_x <- filter(count_reason_AGROECOLOG_x, count_reason_AGROECOLOG_x$reason_cult ==1)
cult_reason_percent_x = data.frame(percentage = (reason_AGROECOLOG_x$n / (sum(count_reason_AGROECOLOG_x$n))*100)) %>% 
  mutate(zone = "x")



####NSW_Central###
reason_AGROECOLOG_NSW_Central <- filter(reason_cult, AGROECOLOG =="NSW Central")
count_reason_AGROECOLOG_NSW_Central <- count(reason_AGROECOLOG_NSW_Central, reason == 1)  %>% 
                              mutate(zone = "NSW_Central",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_NSW_Central <- filter(count_reason_AGROECOLOG_NSW_Central, count_reason_AGROECOLOG_NSW_Central$reason_cult ==1)
cult_reason_percent_NSW_Central = data.frame(percentage = (reason_AGROECOLOG_NSW_Central$n / (sum(count_reason_AGROECOLOG_NSW_Central$n))*100)) %>% 
  mutate(zone = "NSW_Central")
####NSW_NorthEast_Qld_SouthEast###
reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(reason_cult, AGROECOLOG =="NSW NorthEast-Qld SouthEast")
count_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- count(reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast, reason == 1)  %>% 
                              mutate(zone = "NSW_NorthEast_Qld_SouthEast",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(count_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast, count_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$reason_cult ==1)
cult_reason_percent_NSW_NorthEast_Qld_SouthEast = data.frame(percentage = (reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n / (sum(count_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n))*100)) %>% 
  mutate(zone = "NSW_NorthEast_Qld_SouthEast")
####NSW_NorthWest_Qld_SouthWest###
reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(reason_cult, AGROECOLOG =="NSW NorthWest-Qld SouthWest")
count_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- count(reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest, reason == 1)  %>% 
                              mutate(zone = "NSW_NorthWest_Qld_SouthWest",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(count_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest, count_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$reason_cult ==1)
cult_reason_percent_NSW_NorthWest_Qld_SouthWest = data.frame(percentage = (reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n / (sum(count_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n))*100)) %>% 
  mutate(zone = "NSW_NorthWest_Qld_SouthWest")
####NSW_Vic_Slopes###
reason_AGROECOLOG_NSW_Vic_Slopes <- filter(reason_cult, AGROECOLOG =="NSW Vic Slopes")
count_reason_AGROECOLOG_NSW_Vic_Slopes <- count(reason_AGROECOLOG_NSW_Vic_Slopes, reason == 1)  %>% 
                              mutate(zone = "NSW_Vic_Slopes",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_NSW_Vic_Slopes <- filter(count_reason_AGROECOLOG_NSW_Vic_Slopes, count_reason_AGROECOLOG_NSW_Vic_Slopes$reason_cult ==1)
cult_reason_percent_NSW_Vic_Slopes = data.frame(percentage = (reason_AGROECOLOG_NSW_Vic_Slopes$n / (sum(count_reason_AGROECOLOG_NSW_Vic_Slopes$n))*100)) %>% 
  mutate(zone = "NSW_Vic_Slopes")
####Qld_Central###
reason_AGROECOLOG_Qld_Central <- filter(reason_cult, AGROECOLOG =="Qld Central")
count_reason_AGROECOLOG_Qld_Central <- count(reason_AGROECOLOG_Qld_Central, reason == 1)  %>% 
                              mutate(zone = "Qld_Central",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_Qld_Central <- filter(count_reason_AGROECOLOG_Qld_Central, count_reason_AGROECOLOG_Qld_Central$reason_cult ==1)
cult_reason_percent_Qld_Central = data.frame(percentage = (reason_AGROECOLOG_Qld_Central$n / (sum(count_reason_AGROECOLOG_Qld_Central$n))*100)) %>% 
  mutate(zone = "Qld_Central")

####SA_Midnorth_Lower_Yorke_Eyre###
reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(reason_cult, AGROECOLOG =="SA Midnorth-Lower Yorke Eyre")
count_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- count(reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, reason == 1)  %>% 
                              mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(count_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, count_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$reason_cult ==1)
cult_reason_percent_SA_Midnorth_Lower_Yorke_Eyre = data.frame(percentage = (reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n / (sum(count_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n))*100)) %>% 
  mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre")

####SA_Vic_Bordertown_Wimmera###
reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(reason_cult, AGROECOLOG =="SA Vic Bordertown-Wimmera")
count_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- count(reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera, reason == 1)  %>% 
                              mutate(zone = "SA_Vic_Bordertown_Wimmera",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(count_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera, count_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera$reason_cult ==1)
cult_reason_percent_SA_Vic_Bordertown_Wimmera = data.frame(percentage = (reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera$n / (sum(count_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera$n))*100)) %>% 
  mutate(zone = "SA_Vic_Bordertown_Wimmera")

####SA_Vic_Mallee###
reason_AGROECOLOG_SA_Vic_Mallee <- filter(reason_cult, AGROECOLOG =="SA Vic Mallee")
count_reason_AGROECOLOG_SA_Vic_Mallee <- count(reason_AGROECOLOG_SA_Vic_Mallee, reason == 1)  %>% 
                              mutate(zone = "SA_Vic_Mallee",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_SA_Vic_Mallee <- filter(count_reason_AGROECOLOG_SA_Vic_Mallee, count_reason_AGROECOLOG_SA_Vic_Mallee$reason_cult ==1)
cult_reason_percent_SA_Vic_Mallee = data.frame(percentage = (reason_AGROECOLOG_SA_Vic_Mallee$n / (sum(count_reason_AGROECOLOG_SA_Vic_Mallee$n))*100)) %>% 
  mutate(zone = "SA_Vic_Mallee")

####Tas_Grain###
reason_AGROECOLOG_Tas_Grain <- filter(reason_cult, AGROECOLOG =="Tas Grain")
count_reason_AGROECOLOG_Tas_Grain <- count(reason_AGROECOLOG_Tas_Grain, reason == 1)  %>% 
                              mutate(zone = "Tas_Grain",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_Tas_Grain <- filter(count_reason_AGROECOLOG_Tas_Grain, count_reason_AGROECOLOG_Tas_Grain$reason_cult ==1)
cult_reason_percent_Tas_Grain = data.frame(percentage = (reason_AGROECOLOG_Tas_Grain$n / (sum(count_reason_AGROECOLOG_Tas_Grain$n))*100)) %>% 
  mutate(zone = "Tas_Grain")

####Vic_High_Rainfall###
reason_AGROECOLOG_Vic_High_Rainfall <- filter(reason_cult, AGROECOLOG =="Vic High Rainfall")
count_reason_AGROECOLOG_Vic_High_Rainfall <- count(reason_AGROECOLOG_Vic_High_Rainfall, reason == 1)  %>% 
                              mutate(zone = "Vic_High_Rainfall",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_Vic_High_Rainfall <- filter(count_reason_AGROECOLOG_Vic_High_Rainfall, count_reason_AGROECOLOG_Vic_High_Rainfall$reason_cult ==1)
cult_reason_percent_Vic_High_Rainfall = data.frame(percentage = (reason_AGROECOLOG_Vic_High_Rainfall$n / (sum(count_reason_AGROECOLOG_Vic_High_Rainfall$n))*100)) %>% 
  mutate(zone = "Vic_High_Rainfall")

####WA_Central###
reason_AGROECOLOG_WA_Central <- filter(reason_cult, AGROECOLOG =="WA Central")
count_reason_AGROECOLOG_WA_Central <- count(reason_AGROECOLOG_WA_Central, reason == 1)  %>% 
                              mutate(zone = "WA_Central",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_WA_Central <- filter(count_reason_AGROECOLOG_WA_Central, count_reason_AGROECOLOG_WA_Central$reason_cult ==1)
cult_reason_percent_WA_Central = data.frame(percentage = (reason_AGROECOLOG_WA_Central$n / (sum(count_reason_AGROECOLOG_WA_Central$n))*100)) %>% 
  mutate(zone = "WA_Central")

####WA_Eastern###
reason_AGROECOLOG_WA_Eastern <- filter(reason_cult, AGROECOLOG =="WA Eastern")
count_reason_AGROECOLOG_WA_Eastern <- count(reason_AGROECOLOG_WA_Eastern, reason == 1)  %>% 
                              mutate(zone = "WA_Eastern",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_WA_Eastern <- filter(count_reason_AGROECOLOG_WA_Eastern, count_reason_AGROECOLOG_WA_Eastern$reason_cult ==1)
cult_reason_percent_WA_Eastern = data.frame(percentage = (reason_AGROECOLOG_WA_Eastern$n / (sum(count_reason_AGROECOLOG_WA_Eastern$n))*100)) %>% 
  mutate(zone = "WA_Eastern")

####WA_Mallee_Sandplain###
reason_AGROECOLOG_WA_Mallee_Sandplain <- filter(reason_cult, AGROECOLOG =="WA Mallee and Sandplain")
count_reason_AGROECOLOG_WA_Mallee_Sandplain <- count(reason_AGROECOLOG_WA_Mallee_Sandplain, reason == 1)  %>% 
                              mutate(zone = "WA_Mallee_Sandplain",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_AGROECOLOG_WA_Mallee_Sandplain <- filter(count_reason_AGROECOLOG_WA_Mallee_Sandplain, count_reason_AGROECOLOG_WA_Mallee_Sandplain$reason_cult ==1)
cult_reason_percent_WA_Mallee_Sandplain = data.frame(percentage = (reason_AGROECOLOG_WA_Mallee_Sandplain$n / (sum(count_reason_AGROECOLOG_WA_Mallee_Sandplain$n))*100)) %>% 
  mutate(zone = "WA_Mallee_Sandplain")


####WA_Northern###
reason_AGROECOLOG_WA_Northern <- filter(reason_cult, AGROECOLOG =="WA Northern")
count_reason_AGROECOLOG_WA_Northern <- count(reason_AGROECOLOG_WA_Northern, reason == 1)  %>% 
                              mutate(zone = "WA_Northern",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )
glimpse(reason_AGROECOLOG_WA_Northern)

reason_AGROECOLOG_WA_Northern <- filter(count_reason_AGROECOLOG_WA_Northern, count_reason_AGROECOLOG_WA_Northern$reason_cult ==1)
cult_reason_percent_WA_Northern = data.frame(percentage = (reason_AGROECOLOG_WA_Northern$n / (sum(count_reason_AGROECOLOG_WA_Northern$n))*100)) %>% 
  mutate(zone = "WA_Northern")



reason_cultin_AGROECOLOG <-  rbind(cult_reason_percent_NSW_Central,
                                              cult_reason_percent_NSW_NorthEast_Qld_SouthEast,
                                              cult_reason_percent_NSW_NorthWest_Qld_SouthWest,
                                              cult_reason_percent_NSW_Vic_Slopes,
                                              cult_reason_percent_Qld_Central,
                                              cult_reason_percent_SA_Midnorth_Lower_Yorke_Eyre,
                                              cult_reason_percent_SA_Vic_Bordertown_Wimmera,
                                              cult_reason_percent_SA_Vic_Mallee,
                                              cult_reason_percent_Tas_Grain,
                                              cult_reason_percent_Vic_High_Rainfall,
                                              cult_reason_percent_WA_Central,
                                              cult_reason_percent_WA_Eastern,
                                              cult_reason_percent_WA_Mallee_Sandplain,
                                              cult_reason_percent_WA_Northern)
                                            
reason_cultin_AGROECOLOG$percentage <- round(reason_cultin_AGROECOLOG$percentage,digits = 0)

```


reason_cult_state
reason_cultin_AGROECOLOG

```{r main reason for cultivation prior to seeding Region , echo=FALSE}
#Make a data set that has Q19 coded as main 'reason' 1 
reason_cult <- select(cultivation_prior_seeding,
                state, AGROECOLOG, REGIONS, Q19) %>% 
  mutate(reason = if_else(cultivation_prior_seeding$Q19 != -99 & cultivation_prior_seeding$Q19 > 4, "1", "0" ))

glimpse(reason_cult)



####BY REGIONS####
##NOW make df for each REGIONS
##Western, Southern, Northern

####x###
reason_REGIONS_x <- filter(reason_cult, REGIONS =="x")
count_reason_REGIONS_x <- count(reason_REGIONS_x, reason == 1)  %>% 
                              mutate(zone = "x",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_REGIONS_x <- filter(count_reason_REGIONS_x, count_reason_REGIONS_x$reason_cult ==1)
cult_reason_percent_x = data.frame(percentage = (reason_REGIONS_x$n / (sum(count_reason_REGIONS_x$n))*100)) %>% 
  mutate(zone = "x")




####Western###
reason_REGIONS_Western <- filter(reason_cult, REGIONS =="Western")
count_reason_REGIONS_Western <- count(reason_REGIONS_Western, reason == 1)  %>% 
                              mutate(zone = "Western",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_REGIONS_Western <- filter(count_reason_REGIONS_Western, count_reason_REGIONS_Western$reason_cult ==1)
cult_reason_percent_Western = data.frame(percentage = (reason_REGIONS_Western$n / (sum(count_reason_REGIONS_Western$n))*100)) %>% 
  mutate(zone = "Western")


####Southern###
reason_REGIONS_Southern <- filter(reason_cult, REGIONS =="Southern")
count_reason_REGIONS_Southern <- count(reason_REGIONS_Southern, reason == 1)  %>% 
                              mutate(zone = "Southern",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_REGIONS_Southern <- filter(count_reason_REGIONS_Southern, count_reason_REGIONS_Southern$reason_cult ==1)
cult_reason_percent_Southern = data.frame(percentage = (reason_REGIONS_Southern$n / (sum(count_reason_REGIONS_Southern$n))*100)) %>% 
  mutate(zone = "Southern")
####Northern###
reason_REGIONS_Northern <- filter(reason_cult, REGIONS =="Northern")
count_reason_REGIONS_Northern <- count(reason_REGIONS_Northern, reason == 1)  %>% 
                              mutate(zone = "Northern",
                              reason_cult = as.double(`reason == 1`)) %>% 
                              select(zone,reason_cult, n )


reason_REGIONS_Northern <- filter(count_reason_REGIONS_Northern, count_reason_REGIONS_Northern$reason_cult ==1)
cult_reason_percent_Northern = data.frame(percentage = (reason_REGIONS_Northern$n / (sum(count_reason_REGIONS_Northern$n))*100)) %>% 
  mutate(zone = "Northern")

reason_cult_REGIONS <- rbind(cult_reason_percent_Western,
                             cult_reason_percent_Northern,
                             cult_reason_percent_Southern)
reason_cult_REGIONS$percentage <- round(reason_cult_REGIONS$percentage,0)
```


#buring data

Joined it to file://portjervis-gw/C$/Users/ouz001/book_chapter_data/adoption_data/NoTill_postcodes.csv
based on postcodes 

I have used the raw data (because it has postcodes) and removed a number of coloumns.
"file://FSSA2-ADL/clw-share1/Microlab/Weeds/Farmer_Survey/Weed%20in%20Crops%20Study_postcodes_updated8-7-14_Curves.xlsx" (I think its this file - first tab)

Hopefully retaining what I need;

* Q16_ 1 
* Q19
* Q20b
* Q11 Burning prop of land
* Q11a burn for weed managment?

Average percentage of growers cultivating cropping land prior to or at seeding (i.e. not under no-till).

count of growers greater than 0 and not -99

##Average % of growers burning stubble


```{r burning stubble, echo=FALSE}
#bring in the cultivation data with zone info merged 
burning <- read.csv("../Weeds/cultivation.csv")


#Recode burning or not burning
burning <- select(burning, study, state, AGROECOLOG, REGIONS, SLA_CODE11,  Q11, Q11a) %>% 
  mutate(burn = if_else(burning$Q11 != -99 & burning$Q11 > 0, "1", "0" ))
glimpse(burning)

#Recode reason to burn greater than 5
burning <- mutate(burning,burn_reason = if_else(burning$Q11a != -99 & burning$Q11a > 4, "1", "0" ))

#glimpse(burning)


#####Agrozones#####

##NOW make df for each AGROECOLOG
#NSW Central
#NSW NorthEast-Qld SouthEast
#NSW NorthWest-Qld SouthWest
#NSW Vic Slopes
#Qld Central
#SA Midnorth-Lower Yorke Eyre
#SA Vic Bordertown-Wimmera
#SA Vic Mallee
#Tas Grain
#Vic High Rainfall
#WA Central
#WA Eastern
#WA Mallee and Sandplain
##WA Northern

####x###
burn_AGROECOLOG_x <- filter(burning, AGROECOLOG =="x")
count_burn_AGROECOLOG_x <- count(burn_AGROECOLOG_x, burn == 1)  %>% 
                              mutate(zone = "x",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_x <- filter(count_burn_AGROECOLOG_x, count_burn_AGROECOLOG_x$burn ==1)
burn_percent_x = data.frame(percentage = (burn_AGROECOLOG_x$n / (sum(count_burn_AGROECOLOG_x$n))*100)) %>% 
  mutate(zone = "x")


###NSW_Central###
burn_AGROECOLOG_NSW_Central <- filter(burning, AGROECOLOG =="NSW Central")
count_burn_AGROECOLOG_NSW_Central <- count(burn_AGROECOLOG_NSW_Central, burn == 1)  %>% 
                              mutate(zone = "NSW_Central",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_NSW_Central <- filter(count_burn_AGROECOLOG_NSW_Central, count_burn_AGROECOLOG_NSW_Central$burn ==1)
burn_percent_NSW_Central = data.frame(percentage = (burn_AGROECOLOG_NSW_Central$n / (sum(count_burn_AGROECOLOG_NSW_Central$n))*100)) %>% 
  mutate(zone = "NSW_Central")

####NSW_NorthEast_Qld_SouthEast###
burn_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(burning, AGROECOLOG =="NSW NorthEast-Qld SouthEast")
count_burn_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- count(burn_AGROECOLOG_NSW_NorthEast_Qld_SouthEast, burn == 1)  %>% 
                              mutate(zone = "NSW_NorthEast_Qld_SouthEast",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(count_burn_AGROECOLOG_NSW_NorthEast_Qld_SouthEast, count_burn_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$burn ==1)
burn_percent_NSW_NorthEast_Qld_SouthEast = data.frame(percentage = (burn_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n / (sum(count_burn_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n))*100)) %>% 
  mutate(zone = "NSW_NorthEast_Qld_SouthEast")

####NSW_NorthWest_Qld_SouthWest###
burn_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(burning, AGROECOLOG =="NSW NorthWest-Qld SouthWest")
count_burn_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- count(burn_AGROECOLOG_NSW_NorthWest_Qld_SouthWest, burn == 1)  %>% 
                              mutate(zone = "NSW_NorthWest_Qld_SouthWest",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(count_burn_AGROECOLOG_NSW_NorthWest_Qld_SouthWest, count_burn_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$burn ==1)
burn_percent_NSW_NorthWest_Qld_SouthWest = data.frame(percentage = (burn_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n / (sum(count_burn_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n))*100)) %>% 
  mutate(zone = "NSW_NorthWest_Qld_SouthWest")

####NSW_Vic_Slopes###
burn_AGROECOLOG_NSW_Vic_Slopes <- filter(burning, AGROECOLOG =="NSW Vic Slopes")
count_burn_AGROECOLOG_NSW_Vic_Slopes <- count(burn_AGROECOLOG_NSW_Vic_Slopes, burn == 1)  %>% 
                              mutate(zone = "NSW_Vic_Slopes",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_NSW_Vic_Slopes <- filter(count_burn_AGROECOLOG_NSW_Vic_Slopes, count_burn_AGROECOLOG_NSW_Vic_Slopes$burn ==1)
burn_percent_NSW_Vic_Slopes = data.frame(percentage = (burn_AGROECOLOG_NSW_Vic_Slopes$n / (sum(count_burn_AGROECOLOG_NSW_Vic_Slopes$n))*100)) %>% 
  mutate(zone = "NSW_Vic_Slopes")

####Qld_Central###
burn_AGROECOLOG_Qld_Central <- filter(burning, AGROECOLOG =="Qld Central")
count_burn_AGROECOLOG_Qld_Central <- count(burn_AGROECOLOG_Qld_Central, burn == 1)  %>% 
                              mutate(zone = "Qld_Central",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_Qld_Central <- filter(count_burn_AGROECOLOG_Qld_Central, count_burn_AGROECOLOG_Qld_Central$burn ==1)
burn_percent_Qld_Central = data.frame(percentage = (burn_AGROECOLOG_Qld_Central$n / (sum(count_burn_AGROECOLOG_Qld_Central$n))*100)) %>% 
  mutate(zone = "Qld_Central")

####SA_Midnorth_Lower_Yorke_Eyre###
burn_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(burning, AGROECOLOG =="SA Midnorth-Lower Yorke Eyre")
count_burn_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- count(burn_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, burn == 1)  %>% 
                              mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(count_burn_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, count_burn_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$burn ==1)
burn_percent_SA_Midnorth_Lower_Yorke_Eyre = data.frame(percentage = (burn_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n / (sum(count_burn_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n))*100)) %>% 
  mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre")

####SA_Vic_Bordertown_Wimmera###
burn_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(burning, AGROECOLOG =="SA Vic Bordertown-Wimmera")
count_burn_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- count(burn_AGROECOLOG_SA_Vic_Bordertown_Wimmera, burn == 1)  %>% 
                              mutate(zone = "SA_Vic_Bordertown_Wimmera",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(count_burn_AGROECOLOG_SA_Vic_Bordertown_Wimmera, count_burn_AGROECOLOG_SA_Vic_Bordertown_Wimmera$burn ==1)
burn_percent_SA_Vic_Bordertown_Wimmera = data.frame(percentage = (burn_AGROECOLOG_SA_Vic_Bordertown_Wimmera$n / (sum(count_burn_AGROECOLOG_SA_Vic_Bordertown_Wimmera$n))*100)) %>% 
  mutate(zone = "SA_Vic_Bordertown_Wimmera")

####SA_Vic_Mallee###
burn_AGROECOLOG_SA_Vic_Mallee <- filter(burning, AGROECOLOG =="SA Vic Mallee")
count_burn_AGROECOLOG_SA_Vic_Mallee <- count(burn_AGROECOLOG_SA_Vic_Mallee, burn == 1)  %>% 
                              mutate(zone = "SA_Vic_Mallee",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_SA_Vic_Mallee <- filter(count_burn_AGROECOLOG_SA_Vic_Mallee, count_burn_AGROECOLOG_SA_Vic_Mallee$burn ==1)
burn_percent_SA_Vic_Mallee = data.frame(percentage = (burn_AGROECOLOG_SA_Vic_Mallee$n / (sum(count_burn_AGROECOLOG_SA_Vic_Mallee$n))*100)) %>% 
  mutate(zone = "SA_Vic_Mallee")

####Tas_Grain###
burn_AGROECOLOG_Tas_Grain <- filter(burning, AGROECOLOG =="Tas Grain")
count_burn_AGROECOLOG_Tas_Grain <- count(burn_AGROECOLOG_Tas_Grain, burn == 1)  %>% 
                              mutate(zone = "Tas_Grain",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_Tas_Grain <- filter(count_burn_AGROECOLOG_Tas_Grain, count_burn_AGROECOLOG_Tas_Grain$burn ==1)
burn_percent_Tas_Grain = data.frame(percentage = (burn_AGROECOLOG_Tas_Grain$n / (sum(count_burn_AGROECOLOG_Tas_Grain$n))*100)) %>% 
  mutate(zone = "Tas_Grain")

####Vic_High_Rainfall###
burn_AGROECOLOG_Vic_High_Rainfall <- filter(burning, AGROECOLOG =="Vic High Rainfall")
count_burn_AGROECOLOG_Vic_High_Rainfall <- count(burn_AGROECOLOG_Vic_High_Rainfall, burn == 1)  %>% 
                              mutate(zone = "Vic_High_Rainfall",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_Vic_High_Rainfall <- filter(count_burn_AGROECOLOG_Vic_High_Rainfall, count_burn_AGROECOLOG_Vic_High_Rainfall$burn ==1)
burn_percent_Vic_High_Rainfall = data.frame(percentage = (burn_AGROECOLOG_Vic_High_Rainfall$n / (sum(count_burn_AGROECOLOG_Vic_High_Rainfall$n))*100)) %>% 
  mutate(zone = "Vic_High_Rainfall")

####WA_Central###
burn_AGROECOLOG_WA_Central <- filter(burning, AGROECOLOG =="WA Central")
count_burn_AGROECOLOG_WA_Central <- count(burn_AGROECOLOG_WA_Central, burn == 1)  %>% 
                              mutate(zone = "WA_Central",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_WA_Central <- filter(count_burn_AGROECOLOG_WA_Central, count_burn_AGROECOLOG_WA_Central$burn ==1)
burn_percent_WA_Central = data.frame(percentage = (burn_AGROECOLOG_WA_Central$n / (sum(count_burn_AGROECOLOG_WA_Central$n))*100)) %>% 
  mutate(zone = "WA_Central")

####WA_Eastern###
burn_AGROECOLOG_WA_Eastern <- filter(burning, AGROECOLOG =="WA Eastern")
count_burn_AGROECOLOG_WA_Eastern <- count(burn_AGROECOLOG_WA_Eastern, burn == 1)  %>% 
                              mutate(zone = "WA_Eastern",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_WA_Eastern <- filter(count_burn_AGROECOLOG_WA_Eastern, count_burn_AGROECOLOG_WA_Eastern$burn ==1)
burn_percent_WA_Eastern = data.frame(percentage = (burn_AGROECOLOG_WA_Eastern$n / (sum(count_burn_AGROECOLOG_WA_Eastern$n))*100)) %>% 
  mutate(zone = "WA_Eastern")

####WA_Mallee_Sandplain###
burn_AGROECOLOG_WA_Mallee_Sandplain <- filter(burning, AGROECOLOG =="WA Mallee and Sandplain")
count_burn_AGROECOLOG_WA_Mallee_Sandplain <- count(burn_AGROECOLOG_WA_Mallee_Sandplain, burn == 1)  %>% 
                              mutate(zone = "WA_Mallee_Sandplain",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_WA_Mallee_Sandplain <- filter(count_burn_AGROECOLOG_WA_Mallee_Sandplain, count_burn_AGROECOLOG_WA_Mallee_Sandplain$burn ==1)
burn_percent_WA_Mallee_Sandplain = data.frame(percentage = (burn_AGROECOLOG_WA_Mallee_Sandplain$n / (sum(count_burn_AGROECOLOG_WA_Mallee_Sandplain$n))*100)) %>% 
  mutate(zone = "WA_Mallee_Sandplain")

####WA_Northern###
burn_AGROECOLOG_WA_Northern <- filter(burning, AGROECOLOG =="WA Northern")
count_burn_AGROECOLOG_WA_Northern <- count(burn_AGROECOLOG_WA_Northern, burn == 1)  %>% 
                              mutate(zone = "WA_Northern",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )

burn_AGROECOLOG_WA_Northern <- filter(count_burn_AGROECOLOG_WA_Northern, count_burn_AGROECOLOG_WA_Northern$burn ==1)
burn_percent_WA_Northern = data.frame(percentage = (burn_AGROECOLOG_WA_Northern$n / (sum(count_burn_AGROECOLOG_WA_Northern$n))*100)) %>% 
  mutate(zone = "WA_Northern")



burn_AGROECOLOG <- rbind(burn_percent_NSW_Central,
                         burn_percent_NSW_NorthEast_Qld_SouthEast,
                         burn_percent_NSW_NorthWest_Qld_SouthWest,
                         burn_percent_NSW_Vic_Slopes,
                         burn_percent_Qld_Central,
                         burn_percent_SA_Midnorth_Lower_Yorke_Eyre,
                         burn_percent_SA_Vic_Bordertown_Wimmera,
                         burn_percent_SA_Vic_Mallee,
                         burn_percent_Tas_Grain,
                         burn_percent_Vic_High_Rainfall,
                         burn_percent_WA_Central,
                         burn_percent_WA_Eastern,
                         burn_percent_WA_Mallee_Sandplain,
                         burn_percent_WA_Northern)

burn_AGROECOLOG$percentage <- round(burn_AGROECOLOG$percentage,0)





#####Regions#####

##NOW make df for each REGIONS
#Northern
#Western
#Southern
#glimpse(burning)
####x###
burn_REGIONS_x <- filter(burning, REGIONS =="x")
count_burn_REGIONS_x <- count(burn_REGIONS_x, burn == 1)  %>% 
                              mutate(zone = "x",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )
burn_REGIONS_x <- filter(count_burn_REGIONS_x, count_burn_REGIONS_x$burn ==1)
burn_REGIONS_percent_x = data.frame(percentage = (burn_REGIONS_x$n / (sum(count_burn_REGIONS_x$n))*100)) %>% 
  mutate(zone = "x")

####Northern###
burn_REGIONS_Northern <- filter(burning, REGIONS =="Northern")
count_burn_REGIONS_Northern <- count(burn_REGIONS_Northern, burn == 1)  %>% 
                              mutate(zone = "Northern",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )
burn_REGIONS_Northern <- filter(count_burn_REGIONS_Northern, count_burn_REGIONS_Northern$burn ==1)
burn_REGIONS_percent_Northern = data.frame(percentage = (burn_REGIONS_Northern$n / (sum(count_burn_REGIONS_Northern$n))*100)) %>% 
  mutate(zone = "Northern")
####Western###
burn_REGIONS_Western <- filter(burning, REGIONS =="Western")
count_burn_REGIONS_Western <- count(burn_REGIONS_Western, burn == 1)  %>% 
                              mutate(zone = "Northern",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )
burn_REGIONS_Western <- filter(count_burn_REGIONS_Western, count_burn_REGIONS_Western$burn ==1)
burn_REGIONS_percent_Western = data.frame(percentage = (burn_REGIONS_Western$n / (sum(count_burn_REGIONS_Western$n))*100)) %>% 
  mutate(zone = "Western")
####Southern###
burn_REGIONS_Southern <- filter(burning, REGIONS =="Southern")
count_burn_REGIONS_Southern <- count(burn_REGIONS_Southern, burn == 1)  %>% 
                              mutate(zone = "Southern",
                              burn = as.double(`burn == 1`)) %>% 
                              select(zone,burn, n )
burn_REGIONS_Southern <- filter(count_burn_REGIONS_Southern, count_burn_REGIONS_Southern$burn ==1)
burn_REGIONS_percent_Southern = data.frame(percentage = (burn_REGIONS_Southern$n / (sum(count_burn_REGIONS_Southern$n))*100)) %>% 
  mutate(zone = "Southern")



burn_REGIONS <- rbind(burn_REGIONS_percent_Northern,
                      burn_REGIONS_percent_Southern,
                      burn_REGIONS_percent_Western)
burn_REGIONS$percentage <- round(burn_REGIONS$percentage,0)





#####Agrozones with BURN REASON#####
#glimpse(burning)
##NOW make df for each AGROECOLOG
##NSW Central
##NSW NorthEast-Qld SouthEast
##NSW NorthWest-Qld SouthWest
##NSW Vic Slopes
##Qld Central
##SA Midnorth-Lower Yorke Eyre
##SA Vic Bordertown-Wimmera
##SA Vic Mallee
##Tas Grain
##Vic High Rainfall
##WA Central
##WA Eastern
##WA Mallee and Sandplain
##WA Northern

####x###
burn_reason_AGROECOLOG_x <- filter(burning, AGROECOLOG =="x")
count_burn_reason_AGROECOLOG_x <- count(burn_reason_AGROECOLOG_x, burn_reason == 1)  %>% 
                              mutate(zone = "x",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_x <- filter(count_burn_reason_AGROECOLOG_x, count_burn_reason_AGROECOLOG_x$burn_reason ==1)
burn_reason_percent_x = data.frame(percentage = (burn_reason_AGROECOLOG_x$n / (sum(count_burn_reason_AGROECOLOG_x$n))*100)) %>% 
  mutate(zone = "x")


####NSW Central###
burn_reason_AGROECOLOG_NSW_Central <- filter(burning, AGROECOLOG =="NSW Central")
count_burn_reason_AGROECOLOG_NSW_Central <- count(burn_reason_AGROECOLOG_NSW_Central, burn_reason == 1)  %>% 
                              mutate(zone = "NSW_Central",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_NSW_Central <- filter(count_burn_reason_AGROECOLOG_NSW_Central, count_burn_reason_AGROECOLOG_NSW_Central$burn_reason ==1)
burn_reason_percent_NSW_Central = data.frame(percentage = (burn_reason_AGROECOLOG_NSW_Central$n / (sum(count_burn_reason_AGROECOLOG_NSW_Central$n))*100)) %>% 
  mutate(zone = "NSW_Central")

####NSW NorthEast-Qld SouthEast###
burn_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(burning, AGROECOLOG =="NSW NorthEast-Qld SouthEast")
count_burn_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- count(burn_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast, burn_reason == 1)  %>% 
                              mutate(zone = "NSW_NorthEast_Qld_SouthEast",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(count_burn_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast, count_burn_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$burn_reason ==1)
burn_reason_percent_NSW_NorthEast_Qld_SouthEast = data.frame(percentage = (burn_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n / (sum(count_burn_reason_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n))*100)) %>% 
  mutate(zone = "NSW_NorthEast_Qld_SouthEast")
####NSW NorthWest-Qld SouthWest###
burn_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(burning, AGROECOLOG =="NSW NorthWest-Qld SouthWest")
count_burn_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- count(burn_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest, burn_reason == 1)  %>% 
                              mutate(zone = "NSW_NorthWest_Qld_SouthWest",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(count_burn_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest, count_burn_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$burn_reason ==1)
burn_reason_percent_NSW_NorthWest_Qld_SouthWest = data.frame(percentage = (burn_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n / (sum(count_burn_reason_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n))*100)) %>% 
  mutate(zone = "NSW_NorthWest_Qld_SouthWest")
####NSW Vic Slopes###
burn_reason_AGROECOLOG_NSW_Vic_Slopes <- filter(burning, AGROECOLOG =="NSW Vic Slopes")
count_burn_reason_AGROECOLOG_NSW_Vic_Slopes <- count(burn_reason_AGROECOLOG_NSW_Vic_Slopes, burn_reason == 1)  %>% 
                              mutate(zone = "NSW_Vic_Slopes",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_NSW_Vic_Slopes <- filter(count_burn_reason_AGROECOLOG_NSW_Vic_Slopes, count_burn_reason_AGROECOLOG_NSW_Vic_Slopes$burn_reason ==1)
burn_reason_percent_NSW_Vic_Slopes = data.frame(percentage = (burn_reason_AGROECOLOG_NSW_Vic_Slopes$n / (sum(count_burn_reason_AGROECOLOG_NSW_Vic_Slopes$n))*100)) %>% 
  mutate(zone = "NSW_Vic_Slopes")
####Qld Central###
burn_reason_AGROECOLOG_Qld_Central <- filter(burning, AGROECOLOG =="Qld Central")
count_burn_reason_AGROECOLOG_Qld_Central <- count(burn_reason_AGROECOLOG_Qld_Central, burn_reason == 1)  %>% 
                              mutate(zone = "Qld_Central",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_Qld_Central <- filter(count_burn_reason_AGROECOLOG_Qld_Central, count_burn_reason_AGROECOLOG_Qld_Central$burn_reason ==1)
burn_reason_percent_Qld_Central = data.frame(percentage = (burn_reason_AGROECOLOG_Qld_Central$n / (sum(count_burn_reason_AGROECOLOG_Qld_Central$n))*100)) %>% 
  mutate(zone = "Qld_Central")
####SA Midnorth-Lower Yorke Eyre###
burn_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(burning, AGROECOLOG =="SA Midnorth-Lower Yorke Eyre")
count_burn_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- count(burn_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, burn_reason == 1)  %>% 
                              mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(count_burn_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, count_burn_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$burn_reason ==1)
burn_reason_percent_SA_Midnorth_Lower_Yorke_Eyre = data.frame(percentage = (burn_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n / (sum(count_burn_reason_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n))*100)) %>% 
  mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre")
####SA Vic Bordertown-Wimmera###
burn_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(burning, AGROECOLOG =="SA Vic Bordertown-Wimmera")
count_burn_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- count(burn_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera, burn_reason == 1)  %>% 
                              mutate(zone = "SA_Vic_Bordertown_Wimmera",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(count_burn_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera, count_burn_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera$burn_reason ==1)
burn_reason_percent_SA_Vic_Bordertown_Wimmera = data.frame(percentage = (burn_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera$n / (sum(count_burn_reason_AGROECOLOG_SA_Vic_Bordertown_Wimmera$n))*100)) %>% 
  mutate(zone = "SA_Vic_Bordertown_Wimmera")
####SA Vic Mallee###
burn_reason_AGROECOLOG_SA_Vic_Mallee <- filter(burning, AGROECOLOG =="SA Vic Mallee")
count_burn_reason_AGROECOLOG_SA_Vic_Mallee <- count(burn_reason_AGROECOLOG_SA_Vic_Mallee, burn_reason == 1)  %>% 
                              mutate(zone = "SA_Vic_Mallee",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_SA_Vic_Mallee <- filter(count_burn_reason_AGROECOLOG_SA_Vic_Mallee, count_burn_reason_AGROECOLOG_SA_Vic_Mallee$burn_reason ==1)
burn_reason_percent_SA_Vic_Mallee = data.frame(percentage = (burn_reason_AGROECOLOG_SA_Vic_Mallee$n / (sum(count_burn_reason_AGROECOLOG_SA_Vic_Mallee$n))*100)) %>% 
  mutate(zone = "SA_Vic_Mallee")
####Tas Grain###
burn_reason_AGROECOLOG_Tas_Grain <- filter(burning, AGROECOLOG =="Tas Grain")
count_burn_reason_AGROECOLOG_Tas_Grain <- count(burn_reason_AGROECOLOG_Tas_Grain, burn_reason == 1)  %>% 
                              mutate(zone = "Tas_Grain",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_Tas_Grain <- filter(count_burn_reason_AGROECOLOG_Tas_Grain, count_burn_reason_AGROECOLOG_Tas_Grain$burn_reason ==1)
burn_reason_percent_Tas_Grain = data.frame(percentage = (burn_reason_AGROECOLOG_Tas_Grain$n / (sum(count_burn_reason_AGROECOLOG_Tas_Grain$n))*100)) %>% 
  mutate(zone = "Tas_Grain")
####Vic High Rainfall###
burn_reason_AGROECOLOG_Vic_High_Rainfall <- filter(burning, AGROECOLOG =="Vic High Rainfall")
count_burn_reason_AGROECOLOG_Vic_High_Rainfall <- count(burn_reason_AGROECOLOG_Vic_High_Rainfall, burn_reason == 1)  %>% 
                              mutate(zone = "Vic_High_Rainfall",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_Vic_High_Rainfall <- filter(count_burn_reason_AGROECOLOG_Vic_High_Rainfall, count_burn_reason_AGROECOLOG_Vic_High_Rainfall$burn_reason ==1)
burn_reason_percent_Vic_High_Rainfall = data.frame(percentage = (burn_reason_AGROECOLOG_Vic_High_Rainfall$n / (sum(count_burn_reason_AGROECOLOG_Vic_High_Rainfall$n))*100)) %>% 
  mutate(zone = "Vic_High_Rainfall")
####WA Central###
burn_reason_AGROECOLOG_WA_Central <- filter(burning, AGROECOLOG =="WA Central")
count_burn_reason_AGROECOLOG_WA_Central <- count(burn_reason_AGROECOLOG_WA_Central, burn_reason == 1)  %>% 
                              mutate(zone = "WA_Central",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_WA_Central <- filter(count_burn_reason_AGROECOLOG_WA_Central, count_burn_reason_AGROECOLOG_WA_Central$burn_reason ==1)
burn_reason_percent_WA_Central = data.frame(percentage = (burn_reason_AGROECOLOG_WA_Central$n / (sum(count_burn_reason_AGROECOLOG_WA_Central$n))*100)) %>% 
  mutate(zone = "WA_Central")
####WA Eastern###
burn_reason_AGROECOLOG_WA_Eastern <- filter(burning, AGROECOLOG =="WA Eastern")
count_burn_reason_AGROECOLOG_WA_Eastern <- count(burn_reason_AGROECOLOG_WA_Eastern, burn_reason == 1)  %>% 
                              mutate(zone = "WA_Eastern",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_WA_Eastern <- filter(count_burn_reason_AGROECOLOG_WA_Eastern, count_burn_reason_AGROECOLOG_WA_Eastern$burn_reason ==1)
burn_reason_percent_WA_Eastern = data.frame(percentage = (burn_reason_AGROECOLOG_WA_Eastern$n / (sum(count_burn_reason_AGROECOLOG_WA_Eastern$n))*100)) %>% 
  mutate(zone = "WA_Eastern")

####WA Mallee and Sandplain###
burn_reason_AGROECOLOG_WA_Mallee_Sandplain <- filter(burning, AGROECOLOG =="WA Mallee and Sandplain")
count_burn_reason_AGROECOLOG_WA_Mallee_Sandplain <- count(burn_reason_AGROECOLOG_WA_Mallee_Sandplain, burn_reason == 1)  %>% 
                              mutate(zone = "WA_Mallee_Sandplain",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_WA_Mallee_Sandplain <- filter(count_burn_reason_AGROECOLOG_WA_Mallee_Sandplain, count_burn_reason_AGROECOLOG_WA_Mallee_Sandplain$burn_reason ==1)
burn_reason_percent_WA_Mallee_Sandplain = data.frame(percentage = (burn_reason_AGROECOLOG_WA_Mallee_Sandplain$n / (sum(count_burn_reason_AGROECOLOG_WA_Mallee_Sandplain$n))*100)) %>% 
  mutate(zone = "WA_Mallee_Sandplain")

####WA Northern###
burn_reason_AGROECOLOG_WA_Northern <- filter(burning, AGROECOLOG =="WA Northern")
count_burn_reason_AGROECOLOG_WA_Northern <- count(burn_reason_AGROECOLOG_WA_Northern, burn_reason == 1)  %>% 
                              mutate(zone = "WA_Northern",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )

burn_reason_AGROECOLOG_WA_Northern <- filter(count_burn_reason_AGROECOLOG_WA_Northern, count_burn_reason_AGROECOLOG_WA_Northern$burn_reason ==1)
burn_reason_percent_WA_Northern = data.frame(percentage = (burn_reason_AGROECOLOG_WA_Northern$n / (sum(count_burn_reason_AGROECOLOG_WA_Northern$n))*100)) %>% 
  mutate(zone = "WA_Northern")

burn_reason_AGROECOLOG <- rbind(burn_reason_percent_NSW_Central,
                                burn_reason_percent_NSW_NorthEast_Qld_SouthEast,
                                burn_reason_percent_NSW_NorthWest_Qld_SouthWest,
                                burn_reason_percent_NSW_Vic_Slopes,
                                burn_reason_percent_Qld_Central,
                                burn_reason_percent_SA_Midnorth_Lower_Yorke_Eyre,
                                burn_reason_percent_SA_Vic_Bordertown_Wimmera,
                                burn_reason_percent_SA_Vic_Mallee,
                                burn_reason_percent_Tas_Grain,
                                burn_reason_percent_Vic_High_Rainfall,
                                burn_reason_percent_WA_Central,
                                burn_reason_percent_WA_Eastern,
                                burn_reason_percent_WA_Mallee_Sandplain,
                                burn_reason_percent_WA_Northern)
burn_reason_AGROECOLOG$percentage <- round(burn_reason_AGROECOLOG$percentage,0)



#####Regions#####

##NOW make df for each REGIONS
#Northern
#Western
#Southern

####x###
burn_reason_REGIONS_x <- filter(burning, REGIONS =="x")
count_burn_reason_REGIONS_x <- count(burn_reason_REGIONS_x, burn_reason == 1)  %>% 
                              mutate(zone = "x",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )
burn_reason_REGIONS_x <- filter(count_burn_reason_REGIONS_x, count_burn_reason_REGIONS_x$burn_reason ==1)
burn_reason_REGIONS_percent_x = data.frame(percentage = (burn_reason_REGIONS_x$n / (sum(count_burn_reason_REGIONS_x$n))*100)) %>% 
  mutate(zone = "x")

####Northern###
burn_reason_REGIONS_Northern <- filter(burning, REGIONS =="Northern")
count_burn_reason_REGIONS_Northern <- count(burn_reason_REGIONS_Northern, burn_reason == 1)  %>% 
                              mutate(zone = "Northern",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )
burn_reason_REGIONS_Northern <- filter(count_burn_reason_REGIONS_Northern, count_burn_reason_REGIONS_Northern$burn_reason ==1)
burn_reason_REGIONS_percent_Northern = data.frame(percentage = (burn_reason_REGIONS_Northern$n / (sum(count_burn_reason_REGIONS_Northern$n))*100)) %>% 
  mutate(zone = "Northern")
#glimpse(count_burn_reason_REGIONS_Northern)
#glimpse(burn_reason_REGIONS_percent_Northern)

####Western###
burn_reason_REGIONS_Western <- filter(burning, REGIONS =="Western")
count_burn_reason_REGIONS_Western <- count(burn_reason_REGIONS_Western, burn_reason == 1)  %>% 
                              mutate(zone = "Western",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )
burn_reason_REGIONS_Western <- filter(count_burn_reason_REGIONS_Western, count_burn_reason_REGIONS_Western$burn_reason ==1)
burn_reason_REGIONS_percent_Western = data.frame(percentage = (burn_reason_REGIONS_Western$n / (sum(count_burn_reason_REGIONS_Western$n))*100)) %>% 
  mutate(zone = "Western")

####Southern###
burn_reason_REGIONS_Southern <- filter(burning, REGIONS =="Southern")
count_burn_reason_REGIONS_Southern <- count(burn_reason_REGIONS_Southern, burn_reason == 1)  %>% 
                              mutate(zone = "Southern",
                              burn_reason = as.double(`burn_reason == 1`)) %>% 
                              select(zone,burn_reason, n )
burn_reason_REGIONS_Southern <- filter(count_burn_reason_REGIONS_Southern, count_burn_reason_REGIONS_Southern$burn_reason ==1)
burn_reason_REGIONS_percent_Southern = data.frame(percentage = (burn_reason_REGIONS_Southern$n / (sum(count_burn_reason_REGIONS_Southern$n))*100)) %>% 
  mutate(zone = "Southern")


burn_reason_REGIONS <- rbind(burn_reason_REGIONS_percent_Northern,
                             burn_reason_REGIONS_percent_Southern,
                             burn_reason_REGIONS_percent_Western)

burn_reason_REGIONS$percentage <- round(burn_reason_REGIONS$percentage,0)


glimpse(count_burn_REGIONS_Northern)

                             
```

## windrow Burning

```{r narrow windrow buning, echo=FALSE}
#bring in the windrow burning data with zone info merged 
windrow_burning <- read.csv("../Weeds/Raw_data_Weeds_with_postcodes_windrow_burn.csv")



#Recode Q21c 555 = 0 and 1 =1

windrow_burning <- select(windrow_burning, study, state, AGROECOLOG, REGIONS, SLA_CODE11,  Q21c) %>% 
  mutate(windrow_use = if_else(windrow_burning$Q21c == 555 , "0", "1" ))
#glimpse(windrow_burning)
#now we have a data set of windrow burning and its use.


#####Agrozones with WINDROW BURN #####
glimpse(windrow_burning)
##NOW make df for each AGROECOLOG
#NSW Central
#NSW NorthEast-Qld SouthEast
#NSW NorthWest-Qld SouthWest
#NSW Vic Slopes
#Qld Central
#SA Midnorth-Lower Yorke Eyre
#SA Vic Bordertown-Wimmera
#SA Vic Mallee
#Tas Grain
#Vic High Rainfall
#WA Central
#WA Eastern
#WA Mallee and Sandplain
##WA Northern

####x###
windrow_use_AGROECOLOG_x <- filter(windrow_burning, AGROECOLOG =="x")
count_windrow_use_AGROECOLOG_x <- count(windrow_use_AGROECOLOG_x, windrow_use == 1)  %>% 
                              mutate(zone = "x",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_x <- filter(count_windrow_use_AGROECOLOG_x, count_windrow_use_AGROECOLOG_x$windrow_use ==1)
windrow_use_percent_x = data.frame(percentage = (windrow_use_AGROECOLOG_x$n / (sum(count_windrow_use_AGROECOLOG_x$n))*100)) %>% 
  mutate(zone = "x")


####NSW Central###
windrow_use_AGROECOLOG_NSW_Central <- filter(windrow_burning, AGROECOLOG =="NSW Central")
count_windrow_use_AGROECOLOG_NSW_Central <- count(windrow_use_AGROECOLOG_NSW_Central, windrow_use == 1)  %>% 
                              mutate(zone = "NSW_Central",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_NSW_Central <- filter(count_windrow_use_AGROECOLOG_NSW_Central, count_windrow_use_AGROECOLOG_NSW_Central$windrow_use ==1)
windrow_use_percent_NSW_Central = data.frame(percentage = (windrow_use_AGROECOLOG_NSW_Central$n / (sum(count_windrow_use_AGROECOLOG_NSW_Central$n))*100)) %>% 
  mutate(zone = "NSW_Central")


####NSW NorthEast-Qld SouthEast###
windrow_use_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(windrow_burning, AGROECOLOG =="NSW NorthEast-Qld SouthEast")
count_windrow_use_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- count(windrow_use_AGROECOLOG_NSW_NorthEast_Qld_SouthEast, windrow_use == 1)  %>% 
                              mutate(zone = "NSW_NorthEast_Qld_SouthEast",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(count_windrow_use_AGROECOLOG_NSW_NorthEast_Qld_SouthEast, count_windrow_use_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$windrow_use ==1)
windrow_use_percent_NSW_NorthEast_Qld_SouthEast = data.frame(percentage = (windrow_use_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n / (sum(count_windrow_use_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n))*100)) %>% 
  mutate(zone = "NSW_NorthEast_Qld_SouthEast")

####NSW NorthWest-Qld SouthWest###
windrow_use_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(windrow_burning, AGROECOLOG =="NSW NorthWest-Qld SouthWest")
count_windrow_use_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- count(windrow_use_AGROECOLOG_NSW_NorthWest_Qld_SouthWest, windrow_use == 1)  %>% 
                              mutate(zone = "NSW_NorthWest_Qld_SouthWest",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(count_windrow_use_AGROECOLOG_NSW_NorthWest_Qld_SouthWest, count_windrow_use_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$windrow_use ==1)
windrow_use_percent_NSW_NorthWest_Qld_SouthWest = data.frame(percentage = (windrow_use_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n / (sum(count_windrow_use_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n))*100)) %>% 
  mutate(zone = "NSW_NorthWest_Qld_SouthWest")

####NSW Vic Slopes###
windrow_use_AGROECOLOG_NSW_Vic_Slopes <- filter(windrow_burning, AGROECOLOG =="NSW Vic Slopes")
count_windrow_use_AGROECOLOG_NSW_Vic_Slopes <- count(windrow_use_AGROECOLOG_NSW_Vic_Slopes, windrow_use == 1)  %>% 
                              mutate(zone = "NSW_Vic_Slopes",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_NSW_Vic_Slopes <- filter(count_windrow_use_AGROECOLOG_NSW_Vic_Slopes, count_windrow_use_AGROECOLOG_NSW_Vic_Slopes$windrow_use ==1)
windrow_use_percent_NSW_Vic_Slopes = data.frame(percentage = (windrow_use_AGROECOLOG_NSW_Vic_Slopes$n / (sum(count_windrow_use_AGROECOLOG_NSW_Vic_Slopes$n))*100)) %>% 
  mutate(zone = "NSW_Vic_Slopes")

####Qld Central###
windrow_use_AGROECOLOG_Qld_Central <- filter(windrow_burning, AGROECOLOG =="Qld Central")
count_windrow_use_AGROECOLOG_Qld_Central <- count(windrow_use_AGROECOLOG_Qld_Central, windrow_use == 1)  %>% 
                              mutate(zone = "Qld_Central",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_Qld_Central <- filter(count_windrow_use_AGROECOLOG_Qld_Central, count_windrow_use_AGROECOLOG_Qld_Central$windrow_use ==1)
windrow_use_percent_Qld_Central = data.frame(percentage = (windrow_use_AGROECOLOG_Qld_Central$n / (sum(count_windrow_use_AGROECOLOG_Qld_Central$n))*100)) %>% 
  mutate(zone = "Qld_Central")

####SA Midnorth-Lower Yorke Eyre###
windrow_use_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(windrow_burning, AGROECOLOG =="SA Midnorth-Lower Yorke Eyre")
count_windrow_use_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- count(windrow_use_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, windrow_use == 1)  %>% 
                              mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(count_windrow_use_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, count_windrow_use_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$windrow_use ==1)
windrow_use_percent_SA_Midnorth_Lower_Yorke_Eyre = data.frame(percentage = (windrow_use_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n / (sum(count_windrow_use_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n))*100)) %>% 
  mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre")
####SA Vic Bordertown-Wimmera###
windrow_use_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(windrow_burning, AGROECOLOG =="SA Vic Bordertown-Wimmera")
count_windrow_use_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- count(windrow_use_AGROECOLOG_SA_Vic_Bordertown_Wimmera, windrow_use == 1)  %>% 
                              mutate(zone = "SA_Vic_Bordertown_Wimmera",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(count_windrow_use_AGROECOLOG_SA_Vic_Bordertown_Wimmera, count_windrow_use_AGROECOLOG_SA_Vic_Bordertown_Wimmera$windrow_use ==1)
windrow_use_percent_SA_Vic_Bordertown_Wimmera = data.frame(percentage = (windrow_use_AGROECOLOG_SA_Vic_Bordertown_Wimmera$n / (sum(count_windrow_use_AGROECOLOG_SA_Vic_Bordertown_Wimmera$n))*100)) %>% 
  mutate(zone = "SA_Vic_Bordertown_Wimmera")
####SA Vic Mallee###
windrow_use_AGROECOLOG_SA_Vic_Mallee <- filter(windrow_burning, AGROECOLOG =="SA Vic Mallee")
count_windrow_use_AGROECOLOG_SA_Vic_Mallee <- count(windrow_use_AGROECOLOG_SA_Vic_Mallee, windrow_use == 1)  %>% 
                              mutate(zone = "SA_Vic_Mallee",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_SA_Vic_Mallee <- filter(count_windrow_use_AGROECOLOG_SA_Vic_Mallee, count_windrow_use_AGROECOLOG_SA_Vic_Mallee$windrow_use ==1)
windrow_use_percent_SA_Vic_Mallee = data.frame(percentage = (windrow_use_AGROECOLOG_SA_Vic_Mallee$n / (sum(count_windrow_use_AGROECOLOG_SA_Vic_Mallee$n))*100)) %>% 
  mutate(zone = "SA_Vic_Mallee")
####Tas Grain###
windrow_use_AGROECOLOG_Tas_Grain <- filter(windrow_burning, AGROECOLOG =="Tas Grain")
count_windrow_use_AGROECOLOG_Tas_Grain <- count(windrow_use_AGROECOLOG_Tas_Grain, windrow_use == 1)  %>% 
                              mutate(zone = "Tas_Grain",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_Tas_Grain <- filter(count_windrow_use_AGROECOLOG_Tas_Grain, count_windrow_use_AGROECOLOG_Tas_Grain$windrow_use ==1)
windrow_use_percent_Tas_Grain = data.frame(percentage = (windrow_use_AGROECOLOG_Tas_Grain$n / (sum(count_windrow_use_AGROECOLOG_Tas_Grain$n))*100)) %>% 
  mutate(zone = "Tas_Grain")
####Vic High Rainfall###
windrow_use_AGROECOLOG_Vic_High_Rainfall <- filter(windrow_burning, AGROECOLOG =="Vic High Rainfall")
count_windrow_use_AGROECOLOG_Vic_High_Rainfall <- count(windrow_use_AGROECOLOG_Vic_High_Rainfall, windrow_use == 1)  %>% 
                              mutate(zone = "Vic_High_Rainfall",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_Vic_High_Rainfall <- filter(count_windrow_use_AGROECOLOG_Vic_High_Rainfall, count_windrow_use_AGROECOLOG_Vic_High_Rainfall$windrow_use ==1)
windrow_use_percent_Vic_High_Rainfall = data.frame(percentage = (windrow_use_AGROECOLOG_Vic_High_Rainfall$n / (sum(count_windrow_use_AGROECOLOG_Vic_High_Rainfall$n))*100)) %>% 
  mutate(zone = "Vic_High_Rainfall")
####WA Central###
windrow_use_AGROECOLOG_WA_Central <- filter(windrow_burning, AGROECOLOG =="WA Central")
count_windrow_use_AGROECOLOG_WA_Central <- count(windrow_use_AGROECOLOG_WA_Central, windrow_use == 1)  %>% 
                              mutate(zone = "WA_Central",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_WA_Central <- filter(count_windrow_use_AGROECOLOG_WA_Central, count_windrow_use_AGROECOLOG_WA_Central$windrow_use ==1)
windrow_use_percent_WA_Central = data.frame(percentage = (windrow_use_AGROECOLOG_WA_Central$n / (sum(count_windrow_use_AGROECOLOG_WA_Central$n))*100)) %>% 
  mutate(zone = "WA_Central")
####WA Eastern###
windrow_use_AGROECOLOG_WA_Eastern <- filter(windrow_burning, AGROECOLOG =="WA Eastern")
count_windrow_use_AGROECOLOG_WA_Eastern <- count(windrow_use_AGROECOLOG_WA_Eastern, windrow_use == 1)  %>% 
                              mutate(zone = "WA_Eastern",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_WA_Eastern <- filter(count_windrow_use_AGROECOLOG_WA_Eastern, count_windrow_use_AGROECOLOG_WA_Eastern$windrow_use ==1)
windrow_use_percent_WA_Eastern = data.frame(percentage = (windrow_use_AGROECOLOG_WA_Eastern$n / (sum(count_windrow_use_AGROECOLOG_WA_Eastern$n))*100)) %>% 
  mutate(zone = "WA_Eastern")
####WA Mallee and Sandplain###
windrow_use_AGROECOLOG_WA_Mallee_Sandplain <- filter(windrow_burning, AGROECOLOG =="WA Mallee and Sandplain")
count_windrow_use_AGROECOLOG_WA_Mallee_Sandplain <- count(windrow_use_AGROECOLOG_WA_Mallee_Sandplain, windrow_use == 1)  %>% 
                              mutate(zone = "WA_Mallee_Sandplain",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_WA_Mallee_Sandplain <- filter(count_windrow_use_AGROECOLOG_WA_Mallee_Sandplain, count_windrow_use_AGROECOLOG_WA_Mallee_Sandplain$windrow_use ==1)
windrow_use_percent_WA_Mallee_Sandplain = data.frame(percentage = (windrow_use_AGROECOLOG_WA_Mallee_Sandplain$n / (sum(count_windrow_use_AGROECOLOG_WA_Mallee_Sandplain$n))*100)) %>% 
  mutate(zone = "WA_Mallee_Sandplain")
####WA Northern###
windrow_use_AGROECOLOG_WA_Northern <- filter(windrow_burning, AGROECOLOG =="WA Northern")
count_windrow_use_AGROECOLOG_WA_Northern <- count(windrow_use_AGROECOLOG_WA_Northern, windrow_use == 1)  %>% 
                              mutate(zone = "WA_Northern",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )

windrow_use_AGROECOLOG_WA_Northern <- filter(count_windrow_use_AGROECOLOG_WA_Northern, count_windrow_use_AGROECOLOG_WA_Northern$windrow_use ==1)
windrow_use_percent_WA_Northern = data.frame(percentage = (windrow_use_AGROECOLOG_WA_Northern$n / (sum(count_windrow_use_AGROECOLOG_WA_Northern$n))*100)) %>% 
  mutate(zone = "WA_Northern")

windrow_use_AGROECOLOG <- rbind(windrow_use_percent_NSW_Central,
                                windrow_use_percent_NSW_NorthEast_Qld_SouthEast,
                                windrow_use_percent_NSW_NorthWest_Qld_SouthWest,
                                windrow_use_percent_NSW_Vic_Slopes,
                                windrow_use_percent_Qld_Central,
                                windrow_use_percent_SA_Midnorth_Lower_Yorke_Eyre,
                                windrow_use_percent_SA_Vic_Bordertown_Wimmera,
                                windrow_use_percent_SA_Vic_Mallee,
                                windrow_use_percent_Tas_Grain,
                                windrow_use_percent_Vic_High_Rainfall,
                                windrow_use_percent_WA_Central,
                                windrow_use_percent_WA_Eastern,
                                windrow_use_percent_WA_Mallee_Sandplain,
                                windrow_use_percent_WA_Northern)

windrow_use_AGROECOLOG$percentage <- round(windrow_use_AGROECOLOG$percentage, 0)


#####Regions#####

##NOW make df for each REGIONS
#Northern
#Western
#Southern

####x###
windrow_use_REGIONS_x <- filter(windrow_burning, REGIONS =="x")
count_windrow_use_REGIONS_x <- count(windrow_use_REGIONS_x, windrow_use == 1)  %>% 
                              mutate(zone = "x",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )
windrow_use_REGIONS_x <- filter(count_windrow_use_REGIONS_x, count_windrow_use_REGIONS_x$windrow_use ==1)
windrow_use_REGIONS_percent_x = data.frame(percentage = (windrow_use_REGIONS_x$n / (sum(count_windrow_use_REGIONS_x$n))*100)) %>% 
  mutate(zone = "x")

####Northern###
windrow_use_REGIONS_Northern <- filter(windrow_burning, REGIONS =="Northern")
count_windrow_use_REGIONS_Northern <- count(windrow_use_REGIONS_Northern, windrow_use == 1)  %>% 
                              mutate(zone = "Northern",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )
windrow_use_REGIONS_Northern <- filter(count_windrow_use_REGIONS_Northern, count_windrow_use_REGIONS_Northern$windrow_use ==1)
windrow_use_REGIONS_percent_Northern = data.frame(percentage = (windrow_use_REGIONS_Northern$n / (sum(count_windrow_use_REGIONS_Northern$n))*100)) %>% 
  mutate(zone = "Northern")
####Western###
windrow_use_REGIONS_Western <- filter(windrow_burning, REGIONS =="Western")
count_windrow_use_REGIONS_Western <- count(windrow_use_REGIONS_Western, windrow_use == 1)  %>% 
                              mutate(zone = "Western",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )
windrow_use_REGIONS_Western <- filter(count_windrow_use_REGIONS_Western, count_windrow_use_REGIONS_Western$windrow_use ==1)
windrow_use_REGIONS_percent_Western = data.frame(percentage = (windrow_use_REGIONS_Western$n / (sum(count_windrow_use_REGIONS_Western$n))*100)) %>% 
  mutate(zone = "Western")
####Southern###
windrow_use_REGIONS_Southern <- filter(windrow_burning, REGIONS =="Southern")
count_windrow_use_REGIONS_Southern <- count(windrow_use_REGIONS_Southern, windrow_use == 1)  %>% 
                              mutate(zone = "Southern",
                              windrow_use = as.double(`windrow_use == 1`)) %>% 
                              select(zone,windrow_use, n )
windrow_use_REGIONS_Southern <- filter(count_windrow_use_REGIONS_Southern, count_windrow_use_REGIONS_Southern$windrow_use ==1)
windrow_use_REGIONS_percent_Southern = data.frame(percentage = (windrow_use_REGIONS_Southern$n / (sum(count_windrow_use_REGIONS_Southern$n))*100)) %>% 
  mutate(zone = "Southern")

windrow_use_REGIONS <- rbind(windrow_use_REGIONS_percent_Northern,
                             windrow_use_REGIONS_percent_Southern,
                             windrow_use_REGIONS_percent_Western)
windrow_use_REGIONS$percentage <- round(windrow_use_REGIONS$percentage,0)

```

## Adoption of windrow buring


```{r adoption of narrow windrow buning, echo=FALSE}
#bring in the windrow burning data with zone info merged 
windrow_burn_adoption <- read.csv("../Weeds/Raw_data_Weeds_with_postcodes_windrow_burn.csv")



#Recode Q21c 555 = 0 and 1 =1

windrow_burn_adoption <- select(windrow_burn_adoption, study, state, AGROECOLOG, REGIONS, SLA_CODE11,  Q21c, Q21c1, Q21c3) 

windrow_burn_adoption <- mutate(windrow_burn_adoption, year =  if_else(windrow_burn_adoption$Q21c1 == -99 , 0, as.double(windrow_burn_adoption$Q21c1) ))
#now we have a data set of windrow adoption.
#change the year from interger to factor
windrow_burn_adoption <- mutate(windrow_burn_adoption, year_as_factor = as.factor(year))

glimpse(windrow_burn_adoption)  
  
  
#make a function to generate cummulative data
#my df needs to have a clm called 'AGROECOLOG' and 'year_as_factor'
#the zones need to come out of the 'AGROECOLOG' and I need to have number of farmers in this zone

#df = windrow_burn_adoption
#numb_farmers = noTill_n_zones.csv

adoption_curve_function <- function(df, zone, numb_farmers) {
  df_subset <- filter(df, AGROECOLOG == zone)
  count_adoption_year <- count(df_subset,year_as_factor)
  count_adoption_year <- select(count_adoption_year, year = year_as_factor, n)
  years_of_study <- data.frame(year = 1950:2013, 
                               id = 1:64,
                               zone = zone)
  years_of_study <- mutate(years_of_study, year = as.factor(year))
  adoption_df <- left_join(years_of_study, count_adoption_year, by= "year" )
  adoption_df <- mutate(adoption_df, n = replace_na(adoption_df$n, 0))
  adoption_df <- mutate(adoption_df, cummulative = cumsum(adoption_df$n))
  adoption_df <- mutate(adoption_df, cumm_percent = (adoption_df$cummulative/numb_farmers)*100)
  adoption_df$year <- as.double(adoption_df$year)
  
  #return(df_subset)
  return(adoption_df)
}

#windrow_x <- adoption_curve_function(windrow_burn_adoption, "x",  x)


windrow_NSW_Central <- adoption_curve_function(windrow_burn_adoption, "NSW Central",  71)
windrow_NSW_NorthEast_Qld_SouthEast <- adoption_curve_function(windrow_burn_adoption, "NSW NorthEast-Qld SouthEast",  50)
windrow_NSW_NorthWest_Qld_SouthWest <- adoption_curve_function(windrow_burn_adoption, "NSW NorthWest-Qld SouthWest",  42)
windrow_NSW_Vic_Slopes <- adoption_curve_function(windrow_burn_adoption, "NSW Vic Slopes",  31)
windrow_Qld_Central <- adoption_curve_function(windrow_burn_adoption, "Qld Central",  26)
windrow_SA_Midnorth_Lower_Yorke_Eyre <- adoption_curve_function(windrow_burn_adoption, "SA Midnorth-Lower Yorke Eyre",  52)
windrow_SA_Vic_Bordertown_Wimmera <- adoption_curve_function(windrow_burn_adoption, "SA Vic Bordertown-Wimmera",  59)
windrow_SA_Vic_Mallee <- adoption_curve_function(windrow_burn_adoption, "SA Vic Mallee",  48)
windrow_Tas_Grain <- adoption_curve_function(windrow_burn_adoption, "Tas Grain",  5)
windrow_Vic_High_Rainfall <- adoption_curve_function(windrow_burn_adoption, "Vic High Rainfall",  32)
windrow_WA_Central <- adoption_curve_function(windrow_burn_adoption, "WA Central",  45)
windrow_WA_Eastern <- adoption_curve_function(windrow_burn_adoption, "WA Eastern",  47)
windrow_WA_Mallee_Sandplain <- adoption_curve_function(windrow_burn_adoption, "WA Mallee and Sandplain",  40)
windrow_WA_Northern <- adoption_curve_function(windrow_burn_adoption, "WA Northern",  40)

windrow_adoption_AGROECOLOG <- rbind(windrow_NSW_Central,
                                     windrow_NSW_NorthEast_Qld_SouthEast,
                                     windrow_NSW_NorthWest_Qld_SouthWest,
                                     windrow_NSW_Vic_Slopes,
                                     windrow_Qld_Central,
                                     windrow_SA_Midnorth_Lower_Yorke_Eyre,
                                     windrow_SA_Vic_Bordertown_Wimmera,
                                     windrow_SA_Vic_Mallee,
                                     windrow_Tas_Grain,
                                     windrow_Vic_High_Rainfall,
                                     windrow_WA_Central,
                                     windrow_WA_Eastern,
                                     windrow_WA_Mallee_Sandplain,
                                     windrow_WA_Northern)

```
```{r plot windrow burn adoption agro, echo=FALSE}

ggplot(windrow_adoption_AGROECOLOG, aes(year, cumm_percent, group=zone))+
  geom_line()+
  theme_classic()+
  theme(legend.position = "bottom")+
  xlim(1980, 2015)+
  facet_wrap(.~zone)+
  labs(x = "Years",
       y = "Percenatge of farmers")#,
       #title = "Adoption of windrow burning per AgroEcological")
ggsave("windrow burning_adoption_Agro.png")

```



```{r adoption of narrow windrow buning by, eval=FALSE, include=FALSE}
#bring in the windrow burning data with zone info merged 
windrow_burn_adoption <- read.csv("../Weeds/Raw_data_Weeds_with_postcodes_windrow_burn.csv")


#make a function to generate cummulative data
#my df needs to have a clm called 'AGROECOLOG' and 'year_as_factor'
#the zones need to come out of the 'AGROECOLOG' and I need to have number of farmers in this zone

#adoption_curve_function
#df = windrow_burn_adoption

glimpse(windrow_burn_adoption)
#numb_farmers = noTill_n_zones.csv
#Northern 118
#Southern 298
#Western 172



windrow_adoption_Northern <- adoption_curve_function_REGIONS(windrow_burn_adoption, "Northern",  118)
windrow_adoption_Southern <- adoption_curve_function_REGIONS(windrow_burn_adoption, "Southern",  298)
windrow_adoption_Western <- adoption_curve_function_REGIONS(windrow_burn_adoption, "Western",  172)


windrow_adoption_region <- rbind(windrow_adoption_Northern,
                                 windrow_adoption_Southern,
                                 windrow_adoption_Western)


```


```{r plot windrow burn region facet wrap, eval=FALSE, include=FALSE}

ggplot(windrow_adoption_region, aes(year, cumm_percent, group = zone))+
  #geom_line(aes(linetype = zone))+
  geom_line(aes(linetype=zone))+
  theme_classic()+
  theme(legend.position = "bottom")+
 
  xlim(1980, 2015)+
  labs(x = "Years",
       y = "Percenatge of farmers" )
       #title = "Adoption of Windrow burning per Region")
ggsave("windrow_burn_adoption_Region.png")



```


#windrow burn future use


```{r windrow burn future use, echo=FALSE}

glimpse(windrow_burn_adoption)
#recode so that we have new users...Q21c3
#-99 is current users
#1 is new users
#555 is not planning to use
#666 is unsure


windrow_burn_adoption <- mutate(windrow_burn_adoption, new_user_narrow = if_else(windrow_burn_adoption$Q21c3 == 1 , "1", "0" )) 
 

#####Regions#####

##NOW make df for each REGIONS
#Northern
#Western
#Southern

####x###
new_user_narrow_REGIONS_x <- filter(windrow_burn_adoption, REGIONS =="x")
count_new_user_narrow_REGIONS_x <- count(new_user_narrow_REGIONS_x, new_user_narrow == 1)  %>% 
                              mutate(zone = "x",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_REGIONS_x <- filter(count_new_user_narrow_REGIONS_x, count_new_user_narrow_REGIONS_x$new_user_narrow ==1)
new_user_narrow_REGIONS_percent_x = data.frame(percentage = (new_user_narrow_REGIONS_x$n / (sum(count_new_user_narrow_REGIONS_x$n))*100)) %>% 
  mutate(zone = "x")

####Western###
new_user_narrow_REGIONS_Western <- filter(windrow_burn_adoption, REGIONS =="Western")
count_new_user_narrow_REGIONS_Western <- count(new_user_narrow_REGIONS_Western, new_user_narrow == 1)  %>% 
                              mutate(zone = "Western",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )

new_user_narrow_REGIONS_Western <- filter(count_new_user_narrow_REGIONS_Western, count_new_user_narrow_REGIONS_Western$new_user_narrow ==1)
new_user_narrow_REGIONS_percent_Western = data.frame(percentage = (new_user_narrow_REGIONS_Western$n / (sum(count_new_user_narrow_REGIONS_Western$n))*100)) %>% 
  mutate(zone = "Western")

####Northern###
new_user_narrow_REGIONS_Northern <- filter(windrow_burn_adoption, REGIONS =="Northern")
count_new_user_narrow_REGIONS_Northern <- count(new_user_narrow_REGIONS_Northern, new_user_narrow == 1)  %>% 
                              mutate(zone = "Northern",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_REGIONS_Northern <- filter(count_new_user_narrow_REGIONS_Northern, count_new_user_narrow_REGIONS_Northern$new_user_narrow ==1)
new_user_narrow_REGIONS_percent_Northern = data.frame(percentage = (new_user_narrow_REGIONS_Northern$n / (sum(count_new_user_narrow_REGIONS_Northern$n))*100)) %>% 
  mutate(zone = "Northern")
####Southern###
new_user_narrow_REGIONS_Southern <- filter(windrow_burn_adoption, REGIONS =="Southern")
count_new_user_narrow_REGIONS_Southern <- count(new_user_narrow_REGIONS_Southern, new_user_narrow == 1)  %>% 
                              mutate(zone = "Southern",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_REGIONS_Southern <- filter(count_new_user_narrow_REGIONS_Southern, count_new_user_narrow_REGIONS_Southern$new_user_narrow ==1)
new_user_narrow_REGIONS_percent_Southern = data.frame(percentage = (new_user_narrow_REGIONS_Southern$n / (sum(count_new_user_narrow_REGIONS_Southern$n))*100)) %>% 
  mutate(zone = "Southern")

new_user_narrow_windrow_REGIONS <- rbind(new_user_narrow_REGIONS_percent_Northern,
                                         new_user_narrow_REGIONS_percent_Southern,
                                         new_user_narrow_REGIONS_percent_Western)

new_user_narrow_windrow_REGIONS$percentage <- round(new_user_narrow_windrow_REGIONS$percentage,0)



#####AGROECOLOG#####
glimpse(windrow_burn_adoption)
##NOW make df for each AGROECOLOG
##NSW Central
##NSW NorthEast-Qld SouthEast
##NSW NorthWest-Qld SouthWest
##NSW Vic Slopes
##Qld Central
##SA Midnorth-Lower Yorke Eyre
##SA Vic Bordertown-Wimmera
##SA Vic Mallee
##Tas Grain
##Vic High Rainfall
##WA Central
##WA Eastern
##WA Mallee and Sandplain
##WA Northern


####x###
new_user_narrow_AGROECOLOG_x <- filter(windrow_burn_adoption, AGROECOLOG =="x")
count_new_user_narrow_AGROECOLOG_x <- count(new_user_narrow_AGROECOLOG_x, new_user_narrow == 1)  %>% 
                              mutate(zone = "x",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_x <- filter(count_new_user_narrow_AGROECOLOG_x, count_new_user_narrow_AGROECOLOG_x$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_x = data.frame(percentage = (new_user_narrow_AGROECOLOG_x$n / (sum(count_new_user_narrow_AGROECOLOG_x$n))*100)) %>% 
  mutate(zone = "x")

####NSW Central###
new_user_narrow_AGROECOLOG_NSW_Central <- filter(windrow_burn_adoption, AGROECOLOG =="NSW Central")
count_new_user_narrow_AGROECOLOG_NSW_Central <- count(new_user_narrow_AGROECOLOG_NSW_Central, new_user_narrow == 1)  %>% 
                              mutate(zone = "NSW_Central",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_NSW_Central <- filter(count_new_user_narrow_AGROECOLOG_NSW_Central, count_new_user_narrow_AGROECOLOG_NSW_Central$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_NSW_Central = data.frame(percentage = (new_user_narrow_AGROECOLOG_NSW_Central$n / (sum(count_new_user_narrow_AGROECOLOG_NSW_Central$n))*100)) %>% 
  mutate(zone = "NSW_Central")

####NSW NorthEast-Qld SouthEast###
new_user_narrow_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(windrow_burn_adoption, AGROECOLOG =="NSW NorthEast-Qld SouthEast")
count_new_user_narrow_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- count(new_user_narrow_AGROECOLOG_NSW_NorthEast_Qld_SouthEast, new_user_narrow == 1)  %>% 
                              mutate(zone = "NSW_NorthEast_Qld_SouthEast",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_NSW_NorthEast_Qld_SouthEast <- filter(count_new_user_narrow_AGROECOLOG_NSW_NorthEast_Qld_SouthEast, count_new_user_narrow_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_NSW_NorthEast_Qld_SouthEast = data.frame(percentage = (new_user_narrow_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n / (sum(count_new_user_narrow_AGROECOLOG_NSW_NorthEast_Qld_SouthEast$n))*100)) %>% 
  mutate(zone = "NSW_NorthEast_Qld_SouthEast")
####NSW NorthWest-Qld SouthWest###
new_user_narrow_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(windrow_burn_adoption, AGROECOLOG =="NSW NorthWest-Qld SouthWest")
count_new_user_narrow_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- count(new_user_narrow_AGROECOLOG_NSW_NorthWest_Qld_SouthWest, new_user_narrow == 1)  %>% 
                              mutate(zone = "NSW_NorthWest_Qld_SouthWest",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_NSW_NorthWest_Qld_SouthWest <- filter(count_new_user_narrow_AGROECOLOG_NSW_NorthWest_Qld_SouthWest, count_new_user_narrow_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_NSW_NorthWest_Qld_SouthWest = data.frame(percentage = (new_user_narrow_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n / (sum(count_new_user_narrow_AGROECOLOG_NSW_NorthWest_Qld_SouthWest$n))*100)) %>% 
  mutate(zone = "NSW_NorthWest_Qld_SouthWest")
###NSW Vic Slopes####
new_user_narrow_AGROECOLOG_NSW_Vic_Slopes <- filter(windrow_burn_adoption, AGROECOLOG =="NSW Vic Slopes")
count_new_user_narrow_AGROECOLOG_NSW_Vic_Slopes <- count(new_user_narrow_AGROECOLOG_NSW_Vic_Slopes, new_user_narrow == 1)  %>% 
                              mutate(zone = "NSW_Vic_Slopes",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_NSW_Vic_Slopes <- filter(count_new_user_narrow_AGROECOLOG_NSW_Vic_Slopes, count_new_user_narrow_AGROECOLOG_NSW_Vic_Slopes$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_NSW_Vic_Slopes = data.frame(percentage = (new_user_narrow_AGROECOLOG_NSW_Vic_Slopes$n / (sum(count_new_user_narrow_AGROECOLOG_NSW_Vic_Slopes$n))*100)) %>% 
  mutate(zone = "NSW_Vic_Slopes")
####Qld Central###
new_user_narrow_AGROECOLOG_Qld_Central <- filter(windrow_burn_adoption, AGROECOLOG =="Qld Central")
count_new_user_narrow_AGROECOLOG_Qld_Central <- count(new_user_narrow_AGROECOLOG_Qld_Central, new_user_narrow == 1)  %>% 
                              mutate(zone = "Qld_Central",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_Qld_Central <- filter(count_new_user_narrow_AGROECOLOG_Qld_Central, count_new_user_narrow_AGROECOLOG_Qld_Central$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_Qld_Central = data.frame(percentage = (new_user_narrow_AGROECOLOG_Qld_Central$n / (sum(count_new_user_narrow_AGROECOLOG_Qld_Central$n))*100)) %>% 
  mutate(zone = "Qld_Central")
####SA Midnorth-Lower Yorke Eyre###
new_user_narrow_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(windrow_burn_adoption, AGROECOLOG =="SA Midnorth-Lower Yorke Eyre")
count_new_user_narrow_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- count(new_user_narrow_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, new_user_narrow == 1)  %>% 
                              mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre <- filter(count_new_user_narrow_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre, count_new_user_narrow_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_SA_Midnorth_Lower_Yorke_Eyre = data.frame(percentage = (new_user_narrow_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n / (sum(count_new_user_narrow_AGROECOLOG_SA_Midnorth_Lower_Yorke_Eyre$n))*100)) %>% 
  mutate(zone = "SA_Midnorth_Lower_Yorke_Eyre")
####SA Vic Bordertown-Wimmera##
new_user_narrow_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(windrow_burn_adoption, AGROECOLOG =="SA Vic Bordertown-Wimmera")
count_new_user_narrow_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- count(new_user_narrow_AGROECOLOG_SA_Vic_Bordertown_Wimmera, new_user_narrow == 1)  %>% 
                              mutate(zone = "SA_Vic_Bordertown_Wimmera",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_SA_Vic_Bordertown_Wimmera <- filter(count_new_user_narrow_AGROECOLOG_SA_Vic_Bordertown_Wimmera, count_new_user_narrow_AGROECOLOG_SA_Vic_Bordertown_Wimmera$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_SA_Vic_Bordertown_Wimmera = data.frame(percentage = (new_user_narrow_AGROECOLOG_SA_Vic_Bordertown_Wimmera$n / (sum(count_new_user_narrow_AGROECOLOG_SA_Vic_Bordertown_Wimmera$n))*100)) %>% 
  mutate(zone = "SA_Vic_Bordertown_Wimmera")
####SA Vic Mallee###
new_user_narrow_AGROECOLOG_SA_Vic_Mallee <- filter(windrow_burn_adoption, AGROECOLOG =="SA Vic Mallee")
count_new_user_narrow_AGROECOLOG_SA_Vic_Mallee <- count(new_user_narrow_AGROECOLOG_SA_Vic_Mallee, new_user_narrow == 1)  %>% 
                              mutate(zone = "SA_Vic_Mallee",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_SA_Vic_Mallee <- filter(count_new_user_narrow_AGROECOLOG_SA_Vic_Mallee, count_new_user_narrow_AGROECOLOG_SA_Vic_Mallee$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_SA_Vic_Mallee = data.frame(percentage = (new_user_narrow_AGROECOLOG_SA_Vic_Mallee$n / (sum(count_new_user_narrow_AGROECOLOG_SA_Vic_Mallee$n))*100)) %>% 
  mutate(zone = "SA_Vic_Mallee")
####Tas Grain###
new_user_narrow_AGROECOLOG_Tas_Grain <- filter(windrow_burn_adoption, AGROECOLOG =="Tas Grain")
count_new_user_narrow_AGROECOLOG_Tas_Grain <- count(new_user_narrow_AGROECOLOG_Tas_Grain, new_user_narrow == 1)  %>% 
                              mutate(zone = "Tas_Grain",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_Tas_Grain <- filter(count_new_user_narrow_AGROECOLOG_Tas_Grain, count_new_user_narrow_AGROECOLOG_Tas_Grain$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_Tas_Grain = data.frame(percentage = (new_user_narrow_AGROECOLOG_Tas_Grain$n / (sum(count_new_user_narrow_AGROECOLOG_Tas_Grain$n))*100)) %>% 
  mutate(zone = "Tas_Grain")
####Vic High Rainfall###
new_user_narrow_AGROECOLOG_Vic_High_Rainfall <- filter(windrow_burn_adoption, AGROECOLOG =="Vic High Rainfall")
count_new_user_narrow_AGROECOLOG_Vic_High_Rainfall <- count(new_user_narrow_AGROECOLOG_Vic_High_Rainfall, new_user_narrow == 1)  %>% 
                              mutate(zone = "Vic_High_Rainfall",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_Vic_High_Rainfall <- filter(count_new_user_narrow_AGROECOLOG_Vic_High_Rainfall, count_new_user_narrow_AGROECOLOG_Vic_High_Rainfall$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_Vic_High_Rainfall = data.frame(percentage = (new_user_narrow_AGROECOLOG_Vic_High_Rainfall$n / (sum(count_new_user_narrow_AGROECOLOG_Vic_High_Rainfall$n))*100)) %>% 
  mutate(zone = "Vic_High_Rainfall")
####WA Central###
new_user_narrow_AGROECOLOG_WA_Central <- filter(windrow_burn_adoption, AGROECOLOG =="WA Central")
count_new_user_narrow_AGROECOLOG_WA_Central <- count(new_user_narrow_AGROECOLOG_WA_Central, new_user_narrow == 1)  %>% 
                              mutate(zone = "WA_Central",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_WA_Central <- filter(count_new_user_narrow_AGROECOLOG_WA_Central, count_new_user_narrow_AGROECOLOG_WA_Central$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_WA_Central = data.frame(percentage = (new_user_narrow_AGROECOLOG_WA_Central$n / (sum(count_new_user_narrow_AGROECOLOG_WA_Central$n))*100)) %>% 
  mutate(zone = "WA_Central")
####WA Eastern###
new_user_narrow_AGROECOLOG_WA_Eastern <- filter(windrow_burn_adoption, AGROECOLOG =="WA Eastern")
count_new_user_narrow_AGROECOLOG_WA_Eastern <- count(new_user_narrow_AGROECOLOG_WA_Eastern, new_user_narrow == 1)  %>% 
                              mutate(zone = "WA_Eastern",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_WA_Eastern <- filter(count_new_user_narrow_AGROECOLOG_WA_Eastern, count_new_user_narrow_AGROECOLOG_WA_Eastern$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_WA_Eastern = data.frame(percentage = (new_user_narrow_AGROECOLOG_WA_Eastern$n / (sum(count_new_user_narrow_AGROECOLOG_WA_Eastern$n))*100)) %>% 
  mutate(zone = "WA_Eastern")
####WA Mallee and Sandplain###
new_user_narrow_AGROECOLOG_WA_Mallee_Sandplain <- filter(windrow_burn_adoption, AGROECOLOG =="WA Mallee and Sandplain")
count_new_user_narrow_AGROECOLOG_WA_Mallee_Sandplain <- count(new_user_narrow_AGROECOLOG_WA_Mallee_Sandplain, new_user_narrow == 1)  %>% 
                              mutate(zone = "WA_Mallee_Sandplain",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_WA_Mallee_Sandplain <- filter(count_new_user_narrow_AGROECOLOG_WA_Mallee_Sandplain, count_new_user_narrow_AGROECOLOG_WA_Mallee_Sandplain$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_WA_Mallee_Sandplain = data.frame(percentage = (new_user_narrow_AGROECOLOG_WA_Mallee_Sandplain$n / (sum(count_new_user_narrow_AGROECOLOG_WA_Mallee_Sandplain$n))*100)) %>% 
  mutate(zone = "WA_Mallee_Sandplain")
####WA Northern###
new_user_narrow_AGROECOLOG_WA_Northern <- filter(windrow_burn_adoption, AGROECOLOG =="WA Northern")
count_new_user_narrow_AGROECOLOG_WA_Northern <- count(new_user_narrow_AGROECOLOG_WA_Northern, new_user_narrow == 1)  %>% 
                              mutate(zone = "WA_Northern",
                              new_user_narrow = as.double(`new_user_narrow == 1`)) %>% 
                              select(zone,new_user_narrow, n )
new_user_narrow_AGROECOLOG_WA_Northern <- filter(count_new_user_narrow_AGROECOLOG_WA_Northern, count_new_user_narrow_AGROECOLOG_WA_Northern$new_user_narrow ==1)
new_user_narrow_AGROECOLOG_percent_WA_Northern = data.frame(percentage = (new_user_narrow_AGROECOLOG_WA_Northern$n / (sum(count_new_user_narrow_AGROECOLOG_WA_Northern$n))*100)) %>% 
  mutate(zone = "WA_Northern")

new_user_narrow_AGROECOLOG <- rbind(new_user_narrow_AGROECOLOG_percent_NSW_Central,
                                    new_user_narrow_AGROECOLOG_percent_NSW_NorthEast_Qld_SouthEast,
                                    new_user_narrow_AGROECOLOG_percent_NSW_NorthWest_Qld_SouthWest,
                                    new_user_narrow_AGROECOLOG_percent_NSW_Vic_Slopes,
                                    new_user_narrow_AGROECOLOG_percent_Qld_Central,
                                    new_user_narrow_AGROECOLOG_percent_SA_Midnorth_Lower_Yorke_Eyre,
                                    new_user_narrow_AGROECOLOG_percent_SA_Vic_Bordertown_Wimmera,
                                    new_user_narrow_AGROECOLOG_percent_SA_Vic_Mallee,
                                    new_user_narrow_AGROECOLOG_percent_Tas_Grain,
                                    new_user_narrow_AGROECOLOG_percent_Vic_High_Rainfall,
                                    new_user_narrow_AGROECOLOG_percent_WA_Central,
                                    new_user_narrow_AGROECOLOG_percent_WA_Eastern,
                                    new_user_narrow_AGROECOLOG_percent_WA_Mallee_Sandplain,
                                    new_user_narrow_AGROECOLOG_percent_WA_Northern)
new_user_narrow_AGROECOLOG$percentage <- round(new_user_narrow_AGROECOLOG$percentage,0)


```





## PA survey - member of any local farmer group that looks at cropping issues in your district? Q30

```{r PA survey - member of any local farmer group, echo=FALSE}


PA_local_farm_grp <- read.csv("../PA/PA_data_rawish.csv")
#glimpse(PA_local_farm_grp)
PA_local_farm_grp <- select(PA_local_farm_grp,farmer = Respondents ,
                            Member_GroupQ30)
glimpse(PA_local_farm_grp)
glimpse(XYadvisors_postcodes_join)
#join these two dataset togther so we have postcodes
PA_local_farm_grp <-  left_join(PA_local_farm_grp, XYadvisors_postcodes_join, "farmer")




# Member_GroupQ30 1 is YES
PA_local_farm_grp$Member_GroupQ30 <- as.double(PA_local_farm_grp$Member_GroupQ30)
glimpse(PA_local_farm_grp)

#count(PA_local_farm_grp, Member_GroupQ30, Member_GroupQ30==1)
member_local_grp_national <- count(PA_local_farm_grp, Member_GroupQ30)
member_local_grp_national <- mutate(member_local_grp_national, 
                                    question = if_else(member_local_grp_national$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/573)*100)
member_local_grp_national$percent<- round(member_local_grp_national$percent,0)
glimpse(member_local_grp_national)
### National perecentage of growers belonging to local farmer groups.

#####REGION perecentage of growers belonging to local farmer groups.#######


#####Regions#####

##NOW make df for each REGIONS
#Northern
#Western
#Southern

glimpse(PA_local_farm_grp)

PA_local_farm_grp_Western <- filter(PA_local_farm_grp, REGIONS == "Western")
member_local_grp_Western <- count(PA_local_farm_grp_Western, Member_GroupQ30)
member_local_grp_Western <- mutate(member_local_grp_Western, 
                                    question = if_else(member_local_grp_Western$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "Western")
member_local_grp_Western$percent<- round(member_local_grp_Western$percent,0)
#glimpse(member_local_grp_Western)
#glimpse(PA_local_farm_grp_Western)


PA_local_farm_grp_Southern <- filter(PA_local_farm_grp, REGIONS == "Southern")
member_local_grp_Southern <- count(PA_local_farm_grp_Southern, Member_GroupQ30)
member_local_grp_Southern <- mutate(member_local_grp_Southern, 
                                    question = if_else(member_local_grp_Southern$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "Southern")

member_local_grp_Southern$percent<- round(member_local_grp_Southern$percent,0)


member_local_grp_region <- rbind(member_local_grp_Southern,
                                 member_local_grp_Western)




####AGROECOLOG#####

##NOW make df for each AGROECOLOG
#NSW Central
#NSW NorthEast-Qld SouthEast
#NSW NorthWest-Qld SouthWest
#NSW Vic Slopes
#Qld Central
#SA Midnorth-Lower Yorke Eyre
#SA Vic Bordertown-Wimmera
#SA Vic Mallee
#Tas Grain
#Vic High Rainfall
#WA Central
#WA Eastern
#WA Mallee and Sandplain
##WA Northern

glimpse(PA_local_farm_grp)

PA_local_farm_grp_x <- filter(PA_local_farm_grp, REGIONS == "x")
member_local_grp_x <- count(PA_local_farm_grp_x, Member_GroupQ30)
member_local_grp_x <- mutate(member_local_grp_x, 
                                    question = if_else(member_local_grp_x$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "x")




PA_local_farm_grp_NSW_Central <- filter(PA_local_farm_grp, AGROECOLOG == "NSW Central")
member_local_grp_NSW_Central <- count(PA_local_farm_grp_NSW_Central, Member_GroupQ30)
member_local_grp_NSW_Central <- mutate(member_local_grp_NSW_Central, 
                                    question = if_else(member_local_grp_NSW_Central$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "NSW_Central")


PA_local_farm_grp_NSW_NorthEast_Qld_SouthEast <- filter(PA_local_farm_grp, AGROECOLOG == "NSW NorthEast-Qld SouthEast")
member_local_grp_NSW_NorthEast_Qld_SouthEast <- count(PA_local_farm_grp_NSW_NorthEast_Qld_SouthEast, Member_GroupQ30)
member_local_grp_NSW_NorthEast_Qld_SouthEast <- mutate(member_local_grp_NSW_NorthEast_Qld_SouthEast, 
                                    question = if_else(member_local_grp_NSW_NorthEast_Qld_SouthEast$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "NSW_NorthEast_Qld_SouthEast")
PA_local_farm_grp_NSW_NorthWest_Qld_SouthWest <- filter(PA_local_farm_grp, AGROECOLOG == "NSW NorthWest-Qld SouthWest")
member_local_grp_NSW_NorthWest_Qld_SouthWest <- count(PA_local_farm_grp_NSW_NorthWest_Qld_SouthWest, Member_GroupQ30)
member_local_grp_NSW_NorthWest_Qld_SouthWest <- mutate(member_local_grp_NSW_NorthWest_Qld_SouthWest, 
                                    question = if_else(member_local_grp_NSW_NorthWest_Qld_SouthWest$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "NSW_NorthWest_Qld_SouthWest")
PA_local_farm_grp_NSW_Vic_Slopes <- filter(PA_local_farm_grp, AGROECOLOG == "NSW Vic Slopes")
member_local_grp_NSW_Vic_Slopes <- count(PA_local_farm_grp_NSW_Vic_Slopes, Member_GroupQ30)
member_local_grp_NSW_Vic_Slopes <- mutate(member_local_grp_NSW_Vic_Slopes, 
                                    question = if_else(member_local_grp_NSW_Vic_Slopes$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "NSW_Vic_Slopes")
PA_local_farm_grp_Qld_Central <- filter(PA_local_farm_grp, AGROECOLOG == "Qld Central")
member_local_grp_Qld_Central <- count(PA_local_farm_grp_Qld_Central, Member_GroupQ30)
member_local_grp_Qld_Central <- mutate(member_local_grp_Qld_Central, 
                                    question = if_else(member_local_grp_Qld_Central$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "Qld_Central")
PA_local_farm_grp_SA_Midnorth_Lower_Yorke_Eyre <- filter(PA_local_farm_grp, AGROECOLOG == "SA Midnorth-Lower Yorke Eyre")
member_local_grp_SA_Midnorth_Lower_Yorke_Eyre <- count(PA_local_farm_grp_SA_Midnorth_Lower_Yorke_Eyre, Member_GroupQ30)
member_local_grp_SA_Midnorth_Lower_Yorke_Eyre <- mutate(member_local_grp_SA_Midnorth_Lower_Yorke_Eyre, 
                                    question = if_else(member_local_grp_SA_Midnorth_Lower_Yorke_Eyre$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "SA_Midnorth_Lower_Yorke_Eyre")
PA_local_farm_grp_SA_Vic_Bordertown_Wimmera <- filter(PA_local_farm_grp, AGROECOLOG == "SA Vic Bordertown-Wimmera")
member_local_grp_SA_Vic_Bordertown_Wimmera <- count(PA_local_farm_grp_SA_Vic_Bordertown_Wimmera, Member_GroupQ30)
member_local_grp_SA_Vic_Bordertown_Wimmera <- mutate(member_local_grp_SA_Vic_Bordertown_Wimmera, 
                                    question = if_else(member_local_grp_SA_Vic_Bordertown_Wimmera$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "SA_Vic_Bordertown_Wimmera")
PA_local_farm_grp_SA_Vic_Mallee <- filter(PA_local_farm_grp, AGROECOLOG == "SA Vic Mallee")
member_local_grp_SA_Vic_Mallee <- count(PA_local_farm_grp_SA_Vic_Mallee, Member_GroupQ30)
member_local_grp_SA_Vic_Mallee <- mutate(member_local_grp_SA_Vic_Mallee, 
                                    question = if_else(member_local_grp_SA_Vic_Mallee$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "SA_Vic_Mallee")
PA_local_farm_grp_Tas_Grain <- filter(PA_local_farm_grp, AGROECOLOG == "Tas Grain")
member_local_grp_Tas_Grain <- count(PA_local_farm_grp_Tas_Grain, Member_GroupQ30)
member_local_grp_Tas_Grain <- mutate(member_local_grp_Tas_Grain, 
                                    question = if_else(member_local_grp_Tas_Grain$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "Tas_Grain")
PA_local_farm_grp_Vic_High_Rainfall <- filter(PA_local_farm_grp, AGROECOLOG == "Vic High Rainfall")
member_local_grp_Vic_High_Rainfall <- count(PA_local_farm_grp_Vic_High_Rainfall, Member_GroupQ30)
member_local_grp_Vic_High_Rainfall <- mutate(member_local_grp_Vic_High_Rainfall, 
                                    question = if_else(member_local_grp_Vic_High_Rainfall$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "Vic_High_Rainfall")
PA_local_farm_grp_WA_Central <- filter(PA_local_farm_grp, AGROECOLOG == "WA Central")
member_local_grp_WA_Central <- count(PA_local_farm_grp_WA_Central, Member_GroupQ30)
member_local_grp_WA_Central <- mutate(member_local_grp_WA_Central, 
                                    question = if_else(member_local_grp_WA_Central$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "WA_Central")
PA_local_farm_grp_WA_Eastern <- filter(PA_local_farm_grp, AGROECOLOG == "WA Eastern")
member_local_grp_WA_Eastern <- count(PA_local_farm_grp_WA_Eastern, Member_GroupQ30)
member_local_grp_WA_Eastern <- mutate(member_local_grp_WA_Eastern, 
                                    question = if_else(member_local_grp_WA_Eastern$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "WA_Eastern")

PA_local_farm_grp_WA_Mallee_Sandplain <- filter(PA_local_farm_grp, AGROECOLOG == "WA Mallee and Sandplain")
member_local_grp_WA_Mallee_Sandplain <- count(PA_local_farm_grp_WA_Mallee_Sandplain, Member_GroupQ30)
member_local_grp_WA_Mallee_Sandplain <- mutate(member_local_grp_WA_Mallee_Sandplain, 
                                    question = if_else(member_local_grp_WA_Mallee_Sandplain$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "WA_Mallee_Sandplain")
PA_local_farm_grp_WA_Northern <- filter(PA_local_farm_grp, AGROECOLOG == "WA Northern")
member_local_grp_WA_Northern <- count(PA_local_farm_grp_WA_Northern, Member_GroupQ30)
member_local_grp_WA_Northern <- mutate(member_local_grp_WA_Northern, 
                                    question = if_else(member_local_grp_WA_Northern$Member_GroupQ30 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "WA_Northern")


member_local_grp_AGRO <- rbind(member_local_grp_NSW_Central,
                                  member_local_grp_NSW_NorthEast_Qld_SouthEast,
                                  member_local_grp_NSW_NorthWest_Qld_SouthWest,
                                  member_local_grp_NSW_Vic_Slopes,
                                  member_local_grp_Qld_Central,
                                  member_local_grp_SA_Midnorth_Lower_Yorke_Eyre,
                                  member_local_grp_SA_Vic_Bordertown_Wimmera,
                                  member_local_grp_SA_Vic_Mallee,
                                  member_local_grp_Tas_Grain,
                                  member_local_grp_Vic_High_Rainfall,
                                  member_local_grp_WA_Central,
                                  member_local_grp_WA_Eastern,
                                  member_local_grp_WA_Mallee_Sandplain,
                                  member_local_grp_WA_Northern)

member_local_grp_AGRO$percent<- round(member_local_grp_AGRO$percent,0)
```





## PA survey - use a paid advisor? Q31


```{r PA survey - use a paid advisor, eval=FALSE, include=FALSE}


PA_paid_advisorQ31 <- read.csv("../PA/PA_data_rawish.csv")
glimpse(PA_paid_advisorQ31)
PA_paid_advisorQ31 <- select(PA_paid_advisorQ31,farmer = Respondents ,
                            Agro_PayQ31)
glimpse(PA_paid_advisorQ31)
glimpse(XYadvisors_postcodes_join)
#join these two dataset togther so we have postcodes
PA_paid_advisorQ31 <-  left_join(PA_paid_advisorQ31, XYadvisors_postcodes_join, "farmer")





# Member_GroupQ30 1 is YES
glimpse(PA_paid_advisorQ31)
PA_paid_advisorQ31$Agro_PayQ31 <- as.double(PA_paid_advisorQ31$Agro_PayQ31)
glimpse(PA_paid_advisorQ31)

#count(PA_local_farm_grp, Agro_PayQ31, Agro_PayQ31==1)
PA_paid_advisorQ31_national <- count(PA_paid_advisorQ31, Agro_PayQ31)
glimpse(PA_paid_advisorQ31_national)

PA_paid_advisorQ31_national <- mutate(PA_paid_advisorQ31_national, 
                                    question = if_else(PA_paid_advisorQ31_national$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100)
                                    



PA_paid_advisorQ31_national$percent<- round(PA_paid_advisorQ31_national$percent,0)
glimpse(PA_paid_advisorQ31_national)
### National perecentage of growers belonging to local farmer groups.



#####REGION perecentage of growers ussing paid advice.#######


#####Regions#####

##NOW make df for each REGIONS
#Northern
#Western
#Southern

glimpse(PA_local_farm_grp)

PA_paid_advisorQ31_x <- filter(PA_paid_advisorQ31, REGIONS == "x")
PA_paid_advisorQ31_x <- count(PA_paid_advisorQ31_x, Agro_PayQ31)
glimpse(PA_paid_advisorQ31_x)
PA_paid_advisorQ31_x <- mutate(PA_paid_advisorQ31_x, 
                                    question = if_else(PA_paid_advisorQ31_x$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "x")
                                   
                                     
                                   

PA_paid_advisorQ31_Western <- filter(PA_paid_advisorQ31, REGIONS == "Western")
PA_paid_advisorQ31_Western <- count(PA_paid_advisorQ31_Western, Agro_PayQ31)
glimpse(PA_paid_advisorQ31_Western)
PA_paid_advisorQ31_Western <- mutate(PA_paid_advisorQ31_Western, 
                                    question = if_else(PA_paid_advisorQ31_Western$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "Western")

                                          
PA_paid_advisorQ31_Southern <- filter(PA_paid_advisorQ31, REGIONS == "Southern")
PA_paid_advisorQ31_Southern <- count(PA_paid_advisorQ31_Southern, Agro_PayQ31)
glimpse(PA_paid_advisorQ31_Southern)
PA_paid_advisorQ31_Southern <- mutate(PA_paid_advisorQ31_Southern, 
                                    question = if_else(PA_paid_advisorQ31_Southern$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "Southern")                                         


                                                                            
                                          
PA_paid_advisorQ31_Region <- rbind(PA_paid_advisorQ31_Southern,
                                   PA_paid_advisorQ31_Western)                                 
PA_paid_advisorQ31_Region$percent <- round(PA_paid_advisorQ31_Region$percent, 0)                                   
glimpse(PA_paid_advisorQ31_Region)


####AGROECOLOG#####

##NOW make df for each AGROECOLOG
##NSW Central
##NSW NorthEast-Qld SouthEast
##NSW NorthWest-Qld SouthWest
##NSW Vic Slopes
##Qld Central
##SA Midnorth-Lower Yorke Eyre
##SA Vic Bordertown-Wimmera
##SA Vic Mallee
##Tas Grain
##Vic High Rainfall
##WA Central
##WA Eastern
##WA Mallee and Sandplain
##WA Northern

PA_paid_advisorQ31_x <- filter(PA_paid_advisorQ31, AGROECOLOG == "x")
PA_paid_advisorQ31_x <- count(PA_paid_advisorQ31_x, Agro_PayQ31)
glimpse(PA_paid_advisorQ31_x)
PA_paid_advisorQ31_x <- mutate(PA_paid_advisorQ31_x, 
                                    question = if_else(PA_paid_advisorQ31_x$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "x")
glimpse(PA_paid_advisorQ31)

PA_paid_advisorQ31_NSW_Central <- filter(PA_paid_advisorQ31, AGROECOLOG == "NSW Central")
PA_paid_advisorQ31_NSW_Central <- count(PA_paid_advisorQ31_NSW_Central, Agro_PayQ31)
PA_paid_advisorQ31_NSW_Central <- mutate(PA_paid_advisorQ31_NSW_Central, 
                                    question = if_else(PA_paid_advisorQ31_NSW_Central$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "NSW_Central")
PA_paid_advisorQ31_NSW_NorthEast_Qld_SouthEast <- filter(PA_paid_advisorQ31, AGROECOLOG == "NSW NorthEast-Qld SouthEast")
PA_paid_advisorQ31_NSW_NorthEast_Qld_SouthEast <- count(PA_paid_advisorQ31_NSW_NorthEast_Qld_SouthEast, Agro_PayQ31)
PA_paid_advisorQ31_NSW_NorthEast_Qld_SouthEast <- mutate(PA_paid_advisorQ31_NSW_NorthEast_Qld_SouthEast, 
                                    question = if_else(PA_paid_advisorQ31_NSW_NorthEast_Qld_SouthEast$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "NSW_NorthEast_Qld_SouthEast")
PA_paid_advisorQ31_NSW_NorthWest_Qld_SouthWest <- filter(PA_paid_advisorQ31, AGROECOLOG == "NSW NorthWest-Qld SouthWest")
PA_paid_advisorQ31_NSW_NorthWest_Qld_SouthWest <- count(PA_paid_advisorQ31_NSW_NorthWest_Qld_SouthWest, Agro_PayQ31)
PA_paid_advisorQ31_NSW_NorthWest_Qld_SouthWest <- mutate(PA_paid_advisorQ31_NSW_NorthWest_Qld_SouthWest, 
                                    question = if_else(PA_paid_advisorQ31_NSW_NorthWest_Qld_SouthWest$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "NSW_NorthWest_Qld_SouthWest")
PA_paid_advisorQ31_NSW_Vic_Slopes <- filter(PA_paid_advisorQ31, AGROECOLOG == "NSW Vic Slopes")
PA_paid_advisorQ31_NSW_Vic_Slopes <- count(PA_paid_advisorQ31_NSW_Vic_Slopes, Agro_PayQ31)
PA_paid_advisorQ31_NSW_Vic_Slopes <- mutate(PA_paid_advisorQ31_NSW_Vic_Slopes, 
                                    question = if_else(PA_paid_advisorQ31_NSW_Vic_Slopes$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "NSW_Vic_Slopes")
PA_paid_advisorQ31_QldCentral <- filter(PA_paid_advisorQ31, AGROECOLOG == "Qld Central")
PA_paid_advisorQ31_QldCentral <- count(PA_paid_advisorQ31_QldCentral, Agro_PayQ31)
PA_paid_advisorQ31_QldCentral <- mutate(PA_paid_advisorQ31_QldCentral, 
                                    question = if_else(PA_paid_advisorQ31_QldCentral$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "QldCentral")
PA_paid_advisorQ31_SA_Midnorth_Lower_Yorke_Eyre <- filter(PA_paid_advisorQ31, AGROECOLOG == "SA Midnorth-Lower Yorke Eyre")
PA_paid_advisorQ31_SA_Midnorth_Lower_Yorke_Eyre <- count(PA_paid_advisorQ31_SA_Midnorth_Lower_Yorke_Eyre, Agro_PayQ31)
glimpse(PA_paid_advisorQ31_SA_Midnorth_Lower_Yorke_Eyre)
PA_paid_advisorQ31_SA_Midnorth_Lower_Yorke_Eyre <- mutate(PA_paid_advisorQ31_SA_Midnorth_Lower_Yorke_Eyre, 
                                    question = if_else(PA_paid_advisorQ31_x$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "SA_Midnorth_Lower_Yorke_Eyre")
PA_paid_advisorQ31_SA_Vic_Bordertown_Wimmera <- filter(PA_paid_advisorQ31, AGROECOLOG == "SA Vic Bordertown-Wimmera")
PA_paid_advisorQ31_SA_Vic_Bordertown_Wimmera <- count(PA_paid_advisorQ31_SA_Vic_Bordertown_Wimmera, Agro_PayQ31)
PA_paid_advisorQ31_SA_Vic_Bordertown_Wimmera <- mutate(PA_paid_advisorQ31_SA_Vic_Bordertown_Wimmera, 
                                    question = if_else(PA_paid_advisorQ31_SA_Vic_Bordertown_Wimmera$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "SA_Vic_Bordertown_Wimmera")
PA_paid_advisorQ31_SA_Vic_Mallee <- filter(PA_paid_advisorQ31, AGROECOLOG == "SA Vic Mallee")
PA_paid_advisorQ31_SA_Vic_Mallee <- count(PA_paid_advisorQ31_SA_Vic_Mallee, Agro_PayQ31)
PA_paid_advisorQ31_SA_Vic_Mallee <- mutate(PA_paid_advisorQ31_SA_Vic_Mallee, 
                                    question = if_else(PA_paid_advisorQ31_SA_Vic_Mallee$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "SA_Vic_Mallee")
PA_paid_advisorQ31_Tas_Grain <- filter(PA_paid_advisorQ31, AGROECOLOG == "Tas Grain")
PA_paid_advisorQ31_Tas_Grain <- count(PA_paid_advisorQ31_Tas_Grain, Agro_PayQ31)
PA_paid_advisorQ31_Tas_Grain <- mutate(PA_paid_advisorQ31_Tas_Grain, 
                                    question = if_else(PA_paid_advisorQ31_Tas_Grain$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "Tas_Grain")
PA_paid_advisorQ31_Vic_High_Rainfall <- filter(PA_paid_advisorQ31, AGROECOLOG == "Vic High Rainfall")
PA_paid_advisorQ31_Vic_High_Rainfall <- count(PA_paid_advisorQ31_Vic_High_Rainfall, Agro_PayQ31)
PA_paid_advisorQ31_Vic_High_Rainfall <- mutate(PA_paid_advisorQ31_Vic_High_Rainfall, 
                                    question = if_else(PA_paid_advisorQ31_Vic_High_Rainfall$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "Vic_High_Rainfall")
PA_paid_advisorQ31_WA_Central <- filter(PA_paid_advisorQ31, AGROECOLOG == "WA Central")
PA_paid_advisorQ31_WA_Central <- count(PA_paid_advisorQ31_WA_Central, Agro_PayQ31)
PA_paid_advisorQ31_WA_Central <- mutate(PA_paid_advisorQ31_WA_Central, 
                                    question = if_else(PA_paid_advisorQ31_WA_Central$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "WA_Central")
PA_paid_advisorQ31_WA_Eastern <- filter(PA_paid_advisorQ31, AGROECOLOG == "WA Eastern")
PA_paid_advisorQ31_WA_Eastern <- count(PA_paid_advisorQ31_WA_Eastern, Agro_PayQ31)
PA_paid_advisorQ31_WA_Eastern <- mutate(PA_paid_advisorQ31_WA_Eastern, 
                                    question = if_else(PA_paid_advisorQ31_WA_Eastern$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "WA_Eastern")
PA_paid_advisorQ31_WA_Mallee_Sandplain <- filter(PA_paid_advisorQ31, AGROECOLOG == "WA Mallee and Sandplain")
PA_paid_advisorQ31_WA_Mallee_Sandplain <- count(PA_paid_advisorQ31_WA_Mallee_Sandplain, Agro_PayQ31)
PA_paid_advisorQ31_WA_Mallee_Sandplain <- mutate(PA_paid_advisorQ31_WA_Mallee_Sandplain, 
                                    question = if_else(PA_paid_advisorQ31_x$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "WA_Mallee_Sandplain")
PA_paid_advisorQ31_WA_Northern <- filter(PA_paid_advisorQ31, AGROECOLOG == "WA Northern")
PA_paid_advisorQ31_WA_Northern <- count(PA_paid_advisorQ31_WA_Northern, Agro_PayQ31)
PA_paid_advisorQ31_WA_Northern <- mutate(PA_paid_advisorQ31_WA_Northern, 
                                    question = if_else(PA_paid_advisorQ31_x$Agro_PayQ31 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "WA_Northern")

 PA_paid_advisorQ31_Agro <- rbind(PA_paid_advisorQ31_NSW_Central,
                                  PA_paid_advisorQ31_NSW_NorthEast_Qld_SouthEast,
                                  PA_paid_advisorQ31_NSW_NorthWest_Qld_SouthWest,
                                  PA_paid_advisorQ31_NSW_Vic_Slopes,
                                  PA_paid_advisorQ31_QldCentral,
                                  PA_paid_advisorQ31_SA_Midnorth_Lower_Yorke_Eyre,
                                  PA_paid_advisorQ31_SA_Vic_Bordertown_Wimmera,
                                  PA_paid_advisorQ31_SA_Vic_Mallee,
                                  PA_paid_advisorQ31_Tas_Grain,
                                  PA_paid_advisorQ31_Vic_High_Rainfall,
                                  PA_paid_advisorQ31_WA_Central,
                                  PA_paid_advisorQ31_WA_Eastern,
                                  PA_paid_advisorQ31_WA_Mallee_Sandplain,
                                  PA_paid_advisorQ31_WA_Northern)                                 
```


## Main source of cropping advice Q 36

AgroType_IndAgroQ36_1 	
AgroType_DistFreeQ36_2 	
AgroType_DistPaidQ36_3 	
AgroType_DeptAgQ36_4 	
AgroType_OtherQ36_5 


```{r PA survey - Main source of cropping advice, echo=FALSE}


PA_cropping_advice <- read.csv("../PA/PA_data_rawish.csv")
glimpse(PA_cropping_advice)
PA_cropping_advice <- select(PA_cropping_advice,farmer = Respondents ,
                            AgroType_IndAgroQ36_1, 	
                            AgroType_DistFreeQ36_2, 	
                            AgroType_DistPaidQ36_3, 	
                            AgroType_DeptAgQ36_4, 	
                            AgroType_OtherQ36_5)
glimpse(PA_cropping_advice)
glimpse(XYadvisors_postcodes_join)
#join these two dataset togther so we have postcodes
PA_cropping_advice <-  left_join(PA_cropping_advice, XYadvisors_postcodes_join, "farmer")


PA_cropping_advice_national <- count(PA_cropping_advice, AgroType_IndAgroQ36_1)
glimpse(PA_cropping_advice_national)

PA_cropping_advice_national <- mutate(PA_cropping_advice_national, 
                                    question = if_else(PA_cropping_advice_national$AgroType_IndAgroQ36_1 == 1, "YES", "NO"),
                                    percent = (n/sum(n))*100,
                                    zone = "national")
                                    



PA_cropping_advice_national$percent<- round(PA_cropping_advice_national$percent,0)
glimpse(PA_cropping_advice_national)
### National perecentage of growers belonging to local farmer groups.



#####REGION perecentage of growers ussing paid advice.#######


#####Regions OLD WAY#####

##NOW make df for each REGIONS
#Northern
#Western
#Southern
PA_cropping_advice_x <- filter(PA_cropping_advice, REGIONS == "x")
PA_cropping_advice_x <- count(PA_cropping_advice_x, AgroType_IndAgroQ36_1)
glimpse(PA_cropping_advice_x)
PA_cropping_advice_x <- mutate(PA_cropping_advice_x, 
                                    question = if_else(PA_cropping_advice_x$AgroType_IndAgroQ36_1 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "x")
glimpse(PA_cropping_advice)

PA_cropping_advice_Western <- filter(PA_cropping_advice, REGIONS == "Western")
PA_cropping_advice_Western <- count(PA_cropping_advice_Western, AgroType_IndAgroQ36_1)
glimpse(PA_cropping_advice_Western)
PA_cropping_advice_Western <- mutate(PA_cropping_advice_Western, 
                                    question = if_else(PA_cropping_advice_Western$AgroType_IndAgroQ36_1 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "Western")
PA_cropping_advice_Southern <- filter(PA_cropping_advice, REGIONS == "Southern")
PA_cropping_advice_Southern <- count(PA_cropping_advice_Southern, AgroType_IndAgroQ36_1)
glimpse(PA_cropping_advice_Southern)
PA_cropping_advice_Southern <- mutate(PA_cropping_advice_Southern, 
                                    question = if_else(PA_cropping_advice_Southern$AgroType_IndAgroQ36_1 == 1, "YES", "NO"),
                                    percent = (n/sum(n)*100),
                                    zone = "Southern")

PA_cropping_advice_Region <- rbind(PA_cropping_advice_Southern,
                                   PA_cropping_advice_Western)
PA_cropping_advice_Region$percent <- round(PA_cropping_advice_Region$percent,0)
glimpse(PA_cropping_advice_Region)



###TRY USING AGGREGATE SEEMS TO WORK _ NEW WAY#####

###INPUT DATA IS PA_cropping_advice AND REGIONS AND DATA CLM####


#do count for just one data clm
####INFO ON GROUPING HERE IT IS REGIONS ####
REGION <- aggregate(PA_cropping_advice$REGIONS, by = PA_cropping_advice["REGIONS"], FUN = length ) 

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
AgroType_IndAgroQ36_1_REGION <- aggregate(PA_cropping_advice$AgroType_IndAgroQ36_1, 
                                          by= list(PA_cropping_advice$AgroType_IndAgroQ36_1, PA_cropping_advice$REGIONS), 
                                          FUN=length) %>% 
                                          select(AgroType_IndAgroQ36_1 = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION, "REGIONS") %>% 
mutate(perc = (count/x)*100) 
AgroType_IndAgroQ36_1_REGION$perc <- round(AgroType_IndAgroQ36_1_REGION$perc, digits = 0)
print(AgroType_IndAgroQ36_1_REGION)


####INFO ON GROUPING HERE IT IS REGIONS ####
###DATA CLM SPECIFIED AS Y ####
REGION <- aggregate(PA_cropping_advice$REGIONS, by = PA_cropping_advice["REGIONS"], FUN = length ) 
print(REGION)
##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
Y_REGION <- aggregate(PA_cropping_advice$Y, 
                                          by= list(PA_cropping_advice$Y, PA_cropping_advice$REGIONS), 
                                          FUN=length) %>% 
                                          select(Y = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION, "REGIONS") %>% 
mutate(perc = (count/x)*100) 
Y_REGION$perc <- round(Y_REGION$perc, digits = 0)


####INFO ON GROUPING HERE IT IS REGIONS ####
###DATA CLM SPECIFIED AS Y ####
glimpse(PA_cropping_advice)
AGROECOLOG <- aggregate(PA_cropping_advice$REGIONS, by = PA_cropping_advice["AGROECOLOG"], FUN = length ) 
print(AGROECOLOG)
##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
AgroType_IndAgroQ36_1_AGROECOLOG <- aggregate(PA_cropping_advice$AgroType_IndAgroQ36_1, 
                                          by= list(PA_cropping_advice$AgroType_IndAgroQ36_1, PA_cropping_advice$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(Y = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100) 
AgroType_IndAgroQ36_1_AGROECOLOG$perc <- round(AgroType_IndAgroQ36_1_AGROECOLOG$perc, digits = 0)
# glimpse(AgroType_IndAgroQ36_1_AGROECOLOG)      
          


#####REGION perecentage of growers ussing paid advice.AgroType_DistFreeQ36_2 #######

glimpse(PA_cropping_advice)

AgroType_DistFreeQ36_2_REGION <- aggregate(PA_cropping_advice$AgroType_DistFreeQ36_2, 
                                          by= list(PA_cropping_advice$AgroType_DistFreeQ36_2, PA_cropping_advice$REGIONS), 
                                          FUN=length) %>% 
                                          select(AgroType_DistFreeQ36_2 = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION, "REGIONS") %>% 
mutate(perc = (count/x)*100) 
AgroType_DistFreeQ36_2_REGION$perc <- round(AgroType_DistFreeQ36_2_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
AgroType_DistFreeQ36_2_AGROECOLOG <- aggregate(PA_cropping_advice$AgroType_DistFreeQ36_2, 
                                          by= list(PA_cropping_advice$AgroType_DistFreeQ36_2, PA_cropping_advice$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(AgroType_DistFreeQ36_2 = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100) 
AgroType_DistFreeQ36_2_AGROECOLOG$perc <- round(AgroType_DistFreeQ36_2_AGROECOLOG$perc, digits = 0)
# glimpse(AgroType_IndAgroQ36_1_AGROECOLOG)      




#####REGION perecentage of growers ussing paid AgroType_DistPaidQ36_3 #######

glimpse(PA_cropping_advice)

AgroType_DistPaidQ36_3_REGION <- aggregate(PA_cropping_advice$AgroType_DistPaidQ36_3, 
                                          by= list(PA_cropping_advice$AgroType_DistPaidQ36_3, PA_cropping_advice$REGIONS), 
                                          FUN=length) %>% 
                                          select(AgroType_DistPaidQ36_3 = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION, "REGIONS") %>% 
mutate(perc = (count/x)*100) 
AgroType_DistPaidQ36_3_REGION$perc <- round(AgroType_DistPaidQ36_3_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
AgroType_DistPaidQ36_3_AGROECOLOG <- aggregate(PA_cropping_advice$AgroType_DistPaidQ36_3, 
                                          by= list(PA_cropping_advice$AgroType_DistPaidQ36_3, PA_cropping_advice$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(AgroType_DistPaidQ36_3 = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100) 
AgroType_DistPaidQ36_3_AGROECOLOG$perc <- round(AgroType_DistPaidQ36_3_AGROECOLOG$perc, digits = 0)
# glimpse(AgroType_IndAgroQ36_1_AGROECOLOG)   




#####REGION perecentage of growers ussing paid AgroType_DeptAgQ36_4 #######

glimpse(PA_cropping_advice)

AgroType_DeptAgQ36_4_REGION <- aggregate(PA_cropping_advice$AgroType_DeptAgQ36_4, 
                                          by= list(PA_cropping_advice$AgroType_DeptAgQ36_4, PA_cropping_advice$REGIONS), 
                                          FUN=length) %>% 
                                          select(AgroType_DeptAgQ36_4 = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION, "REGIONS") %>% 
mutate(perc = (count/x)*100) 
AgroType_DeptAgQ36_4_REGION$perc <- round(AgroType_DeptAgQ36_4_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
AgroType_DeptAgQ36_4_AGROECOLOG <- aggregate(PA_cropping_advice$AgroType_DeptAgQ36_4, 
                                          by= list(PA_cropping_advice$AgroType_DeptAgQ36_4, PA_cropping_advice$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(AgroType_DeptAgQ36_4 = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100) 
AgroType_DeptAgQ36_4_AGROECOLOG$perc <- round(AgroType_DeptAgQ36_4_AGROECOLOG$perc, digits = 0)
# glimpse(AgroType_IndAgroQ36_1_AGROECOLOG) 



#####REGION perecentage of growers ussing paid AgroType_OtherQ36_5 #######

glimpse(PA_cropping_advice)

AgroType_OtherQ36_5_REGION <- aggregate(PA_cropping_advice$AgroType_OtherQ36_5, 
                                          by= list(PA_cropping_advice$AgroType_OtherQ36_5, PA_cropping_advice$REGIONS), 
                                          FUN=length) %>% 
                                          select(AgroType_OtherQ36_5 = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION, "REGIONS") %>% 
mutate(perc = (count/x)*100) 
AgroType_OtherQ36_5_REGION$perc <- round(AgroType_OtherQ36_5_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
AgroType_OtherQ36_5_AGROECOLOG <- aggregate(PA_cropping_advice$AgroType_OtherQ36_5, 
                                          by= list(PA_cropping_advice$AgroType_OtherQ36_5, PA_cropping_advice$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(AgroType_OtherQ36_5 = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100) 
AgroType_OtherQ36_5_AGROECOLOG$perc <- round(AgroType_OtherQ36_5_AGROECOLOG$perc, digits = 0)
# glimpse(AgroType_IndAgroQ36_1_AGROECOLOG)
```



#### NO Till Perception questions for Q26
GRDC_Weed_in_Crops_rawish
RANK 1 more, 2 less, 3 same

Q26_1
Q26_2 these are all -999 perhaps its had shifted down one?
Q26_3
Q26_4
Q26_5 
Q26_6
Q26_7
Q26_8
Q27 - do you pay a consultant advisor or argo for cropping advice YES =1


```{r PA survey - NO Till Perception questions for Q26, echo=FALSE}
No_Till_perception <- read_excel("../Weeds/Raw_data_Weeds_with_postcodes.xlsx", sheet= "GRDC_Weed_in_Crops_rawish")
No_Till_perception <- select(No_Till_perception,farmer,
                             AGROECOLOG,
                             REGIONS,
                             Q26_1, Q26_2, Q26_3, Q26_4, Q26_5,Q26_6, Q26_7,Q26_8, Q27)
                             
                             

                           
###COUNTS FOR WEEDS SURVEY REGION AND ARGO#####
glimpse(No_Till_perception)
REGION_No_Till <- aggregate(No_Till_perception$REGIONS, by = No_Till_perception["REGIONS"], FUN = length ) 
AGROECOLOG_No_Till <- aggregate(No_Till_perception$AGROECOLOG, by = No_Till_perception["AGROECOLOG"], FUN = length )


###PRECEPTION Q27 PAY CONSt ARGO#####

Q27_REGION <- aggregate(No_Till_perception$Q27, 
                                          by= list(No_Till_perception$Q27, No_Till_perception$REGIONS), 
                                          FUN=length) %>% 
                                          select(Q27 = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION_No_Till, "REGIONS") %>% 
mutate(perc = (count/x)*100) 
Q27_REGION$perc <- round(Q27_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
Q27_AGROECOLOG <- aggregate(No_Till_perception$Q27, 
                                          by= list(No_Till_perception$Q27, No_Till_perception$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(Q27 = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG_No_Till, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100) 
Q27_AGROECOLOG$perc <- round(Q27_AGROECOLOG$perc, digits = 0)

###PRECEPTION Q26_1#####


Q26_1_REGION <- aggregate(No_Till_perception$Q26_1, 
                                          by= list(No_Till_perception$Q26_1, No_Till_perception$REGIONS), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION_No_Till, "REGIONS") %>% 
mutate(perc = (count/x)*100,
        question = "Q26_1")
  
Q26_1_REGION$perc <- round(Q26_1_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
Q26_1_AGROECOLOG <- aggregate(No_Till_perception$Q26_1, 
                                          by= list(No_Till_perception$Q26_1, No_Till_perception$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG_No_Till, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_1") 
Q26_1_AGROECOLOG$perc <- round(Q26_1_AGROECOLOG$perc, digits = 0)
# glimpse(AgroType_IndAgroQ36_1_AGROECOLOG)

###PRECEPTION Q26_3 I think this is weed cost the script says something different#####


Q26_3_REGION <- aggregate(No_Till_perception$Q26_3, 
                                          by= list(No_Till_perception$Q26_3, No_Till_perception$REGIONS), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION_No_Till, "REGIONS") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_3") 
Q26_3_REGION$perc <- round(Q26_3_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
Q26_3_AGROECOLOG <- aggregate(No_Till_perception$Q26_3, 
                                          by= list(No_Till_perception$Q26_3, No_Till_perception$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG_No_Till, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_3") 
Q26_3_AGROECOLOG$perc <- round(Q26_3_AGROECOLOG$perc, digits = 0)
# glimpse(AgroType_IndAgroQ36_1_AGROECOLOG)

###PRECEPTION Q26_4 #####


Q26_4_REGION <- aggregate(No_Till_perception$Q26_4, 
                                          by= list(No_Till_perception$Q26_4, No_Till_perception$REGIONS), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION_No_Till, "REGIONS") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_4") 
Q26_4_REGION$perc <- round(Q26_4_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
Q26_4_AGROECOLOG <- aggregate(No_Till_perception$Q26_4, 
                                          by= list(No_Till_perception$Q26_4, No_Till_perception$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG_No_Till, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_4") 
Q26_4_AGROECOLOG$perc <- round(Q26_4_AGROECOLOG$perc, digits = 0)
# glimpse(AgroType_IndAgroQ36_1_AGROECOLOG)

###PRECEPTION Q26_5 #####


Q26_5_REGION <- aggregate(No_Till_perception$Q26_5, 
                                          by= list(No_Till_perception$Q26_5, No_Till_perception$REGIONS), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION_No_Till, "REGIONS") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_5") 
Q26_5_REGION$perc <- round(Q26_5_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
Q26_5_AGROECOLOG <- aggregate(No_Till_perception$Q26_5, 
                                          by= list(No_Till_perception$Q26_5, No_Till_perception$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG_No_Till, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_5") 
Q26_5_AGROECOLOG$perc <- round(Q26_5_AGROECOLOG$perc, digits = 0)

###PRECEPTION Q26_6 #####


Q26_6_REGION <- aggregate(No_Till_perception$Q26_6, 
                                          by= list(No_Till_perception$Q26_6, No_Till_perception$REGIONS), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION_No_Till, "REGIONS") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_6") 
Q26_6_REGION$perc <- round(Q26_6_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
Q26_6_AGROECOLOG <- aggregate(No_Till_perception$Q26_6, 
                                          by= list(No_Till_perception$Q26_6, No_Till_perception$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG_No_Till, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_6") 
Q26_6_AGROECOLOG$perc <- round(Q26_6_AGROECOLOG$perc, digits = 0)

###PRECEPTION Q26_7 #####


Q26_7_REGION <- aggregate(No_Till_perception$Q26_7, 
                                          by= list(No_Till_perception$Q26_7, No_Till_perception$REGIONS), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION_No_Till, "REGIONS") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_7") 
Q26_7_REGION$perc <- round(Q26_7_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
Q26_7_AGROECOLOG <- aggregate(No_Till_perception$Q26_7, 
                                          by= list(No_Till_perception$Q26_7, No_Till_perception$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG_No_Till, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_7") 
Q26_7_AGROECOLOG$perc <- round(Q26_7_AGROECOLOG$perc, digits = 0)

###PRECEPTION Q26_8 #####


Q26_8_REGION <- aggregate(No_Till_perception$Q26_8, 
                                          by= list(No_Till_perception$Q26_8, No_Till_perception$REGIONS), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          REGIONS = Group.2,
                                          count = x) %>% 
left_join(REGION_No_Till, "REGIONS") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_8") 
Q26_8_REGION$perc <- round(Q26_8_REGION$perc, digits = 0)

##USE AGGREGATE FUNCTION TO SUMMARIES - COUNT / Length of two data clms###
Q26_8_AGROECOLOG <- aggregate(No_Till_perception$Q26_8, 
                                          by= list(No_Till_perception$Q26_8, No_Till_perception$AGROECOLOG), 
                                          FUN=length) %>% 
                                          select(Ans = Group.1,
                                          AGROECOLOG = Group.2,
                                          count = x) %>% 
left_join(AGROECOLOG_No_Till, "AGROECOLOG") %>% 
mutate(perc = (count/x)*100,
       question = "Q26_8") 
Q26_8_AGROECOLOG$perc <- round(Q26_8_AGROECOLOG$perc, digits = 0)

perception_question_REGION <- rbind(Q26_1_REGION,
                             Q26_3_REGION,
                             Q26_4_REGION,
                             Q26_5_REGION,
                             Q26_6_REGION,
                             Q26_7_REGION,
                             Q26_8_REGION)
write.csv(perception_question_REGION,"perception_question_REGION.csv")


perception_question_AGRO <- rbind(Q26_1_AGROECOLOG,
                             Q26_3_AGROECOLOG,
                             Q26_4_AGROECOLOG,
                             Q26_5_AGROECOLOG,
                             Q26_6_AGROECOLOG,
                             Q26_8_AGROECOLOG)
write.csv(perception_question_AGRO,"perception_question_AGRO.csv")
```